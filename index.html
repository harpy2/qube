<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QUBE â€” í’€ì–´ë¼. íƒˆì¶œí•˜ë¼.</title>
<meta name="description" content="ë°©íƒˆì¶œ ì¶”ë¦¬ í¼ì¦ ê²Œì„. ë‹¨ì„œë¥¼ ì°¾ê³ , í¼ì¦ì„ í’€ê³ , íƒˆì¶œí•˜ë¼.">
<meta property="og:title" content="QUBE â€” ë°©íƒˆì¶œ ì¶”ë¦¬ í¼ì¦ ê²Œì„">
<meta property="og:description" content="í’€ì–´ë¼. íƒˆì¶œí•˜ë¼.">
<meta property="og:type" content="website">
<meta property="og:url" content="https://qube.salmonholic.com">
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ”’</text></svg>">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#0a0a0a;--bg2:#111;--bg3:#1a1a1a;
  --text:#e0e0e0;--text2:#888;--text3:#555;
  --accent:#b44aff;--accent2:#9333ea;--accent-glow:rgba(180,74,255,.15);
  --cyan:#00e5ff;--danger:#ff4444;--success:#00ff88;
  --card:rgba(255,255,255,.03);--card-border:rgba(255,255,255,.06);
}
html{scroll-behavior:smooth}
body{background:var(--bg);color:var(--text);font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Noto Sans KR',sans-serif;line-height:1.6;overflow-x:hidden}
.hidden{display:none!important}

/* Hero */
.hero{min-height:100vh;display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;position:relative;overflow:hidden;padding:2rem}
.hero::before{content:'';position:absolute;inset:0;background:radial-gradient(ellipse at 50% 40%,rgba(180,74,255,.06) 0%,transparent 70%);pointer-events:none}
.hero h1{font-size:clamp(3rem,10vw,6rem);font-weight:900;letter-spacing:0.1em;margin-bottom:1rem;background:linear-gradient(135deg,#fff 0%,#b44aff 50%,#00e5ff 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.hero p{font-size:clamp(1rem,3vw,1.3rem);color:var(--text2);max-width:450px;margin-bottom:2.5rem}
.hero-cta{padding:16px 48px;background:linear-gradient(135deg,var(--accent),var(--cyan));color:#000;font-size:1.1rem;font-weight:700;border:none;border-radius:50px;cursor:pointer;transition:all .3s;letter-spacing:.05em}
.hero-cta:hover{transform:translateY(-2px);box-shadow:0 8px 30px rgba(180,74,255,.4)}
.scroll-hint{position:absolute;bottom:2rem;animation:bounce 2s infinite;color:var(--text3);font-size:1.5rem}
@keyframes bounce{0%,100%{transform:translateY(0)}50%{transform:translateY(10px)}}

/* Particles */
.particles{position:absolute;inset:0;pointer-events:none;overflow:hidden}
.particle{position:absolute;width:3px;height:3px;border-radius:50%;opacity:.4;animation:float linear infinite}
@keyframes float{0%{transform:translateY(100vh) scale(0);opacity:0}10%{opacity:.4}90%{opacity:.4}100%{transform:translateY(-10vh) scale(1);opacity:0}}

/* Stats Bar */
.stats-bar{display:flex;justify-content:center;gap:40px;padding:24px 0;margin-bottom:1rem}
.stat{text-align:center}
.stat-val{font-size:2rem;font-weight:900;background:linear-gradient(135deg,var(--accent),var(--cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.stat-label{font-size:.8rem;color:var(--text2);margin-top:4px}

/* Series Section */
.series-section{max-width:700px;margin:0 auto;padding:0 1.5rem 4rem}
.series-section h2{font-size:1.5rem;margin-bottom:.5rem;display:flex;align-items:center;gap:8px}
.series-progress-text{color:var(--text2);font-size:.85rem;margin-bottom:1.5rem}

/* Series Card */
.series-card{background:var(--card);border:1px solid var(--card-border);border-radius:20px;padding:1.8rem;margin-bottom:1.2rem;backdrop-filter:blur(10px);transition:all .3s;cursor:pointer;position:relative;overflow:hidden}
.series-card:hover:not(.locked){border-color:rgba(180,74,255,.3);background:rgba(255,255,255,.05);transform:translateY(-3px);box-shadow:0 8px 30px rgba(180,74,255,.1)}
.series-card.locked{opacity:.45;filter:saturate(.3);cursor:not-allowed}
.series-card.cleared{border-color:rgba(0,255,136,.2)}
.series-lock-overlay{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,.4);backdrop-filter:blur(2px);border-radius:20px;z-index:2}
.series-lock-overlay span{font-size:1rem;color:var(--text2);background:rgba(0,0,0,.6);padding:8px 20px;border-radius:50px}
.series-header{display:flex;align-items:center;gap:16px;margin-bottom:12px}
.series-icon{font-size:2.8rem}
.series-info{flex:1}
.series-title{font-size:1.2rem;font-weight:700}
.series-diff{font-size:.85rem;color:var(--text2);margin-top:2px}
.series-diff .star{color:var(--accent)}
.series-diff .star.empty{color:var(--text3)}
.series-desc{font-size:.9rem;color:var(--text2);line-height:1.6;margin-bottom:12px}
.series-footer{display:flex;align-items:center;justify-content:space-between}
.series-chapter-progress{font-size:.85rem;color:var(--text2)}
.series-chapter-progress .done{color:var(--success)}
.series-badge{padding:4px 14px;border-radius:20px;font-size:.75rem;font-weight:700}
.badge-clear{background:var(--success);color:#000}
.badge-progress{background:var(--accent);color:#fff}
.badge-new{background:rgba(180,74,255,.2);color:var(--accent);border:1px solid rgba(180,74,255,.3)}

/* Chapter Select Screen */
#chapters{max-width:700px;margin:0 auto;min-height:100vh;padding:1rem}
.chapter-header{display:flex;align-items:center;padding:1rem 0;border-bottom:1px solid var(--card-border);margin-bottom:2rem;gap:12px}
.chapter-back{background:none;border:none;color:var(--text2);font-size:1.3rem;cursor:pointer;padding:4px 8px}
.chapter-back:hover{color:var(--text)}
.chapter-series-title{font-size:1.2rem;font-weight:700;flex:1}
.chapter-series-desc{color:var(--text2);font-size:.9rem;line-height:1.7;margin-bottom:2rem;padding:0 .5rem}

/* Timeline */
.chapter-timeline{position:relative;padding-left:32px}
.chapter-timeline::before{content:'';position:absolute;left:11px;top:20px;bottom:20px;width:2px;background:linear-gradient(to bottom,var(--accent),var(--cyan));opacity:.3}
.chapter-item{position:relative;margin-bottom:1.5rem}
.chapter-dot{position:absolute;left:-32px;top:18px;width:22px;height:22px;border-radius:50%;border:2px solid var(--text3);background:var(--bg);display:flex;align-items:center;justify-content:center;font-size:.7rem;z-index:1}
.chapter-item.unlocked .chapter-dot{border-color:var(--accent);box-shadow:0 0 8px rgba(180,74,255,.4)}
.chapter-item.cleared .chapter-dot{border-color:var(--success);background:var(--success);color:#000}
.chapter-card{background:var(--card);border:1px solid var(--card-border);border-radius:16px;padding:1.3rem 1.5rem;transition:all .3s}
.chapter-item.unlocked .chapter-card{border-color:rgba(180,74,255,.2)}
.chapter-item.unlocked .chapter-card:hover{border-color:rgba(180,74,255,.4);background:rgba(255,255,255,.05);transform:translateX(4px)}
.chapter-item.locked .chapter-card{opacity:.4;filter:saturate(.3)}
.chapter-card-title{font-size:1.05rem;font-weight:700;margin-bottom:4px}
.chapter-card-desc{font-size:.85rem;color:var(--text2);margin-bottom:10px}
.chapter-card-meta{display:flex;align-items:center;gap:12px;font-size:.8rem;color:var(--text2)}
.chapter-enter{padding:8px 20px;background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff;border:none;border-radius:50px;cursor:pointer;font-size:.85rem;font-weight:600;transition:all .3s}
.chapter-enter:hover{box-shadow:0 4px 15px rgba(180,74,255,.4)}
.chapter-replay{padding:8px 20px;background:var(--bg3);color:var(--text2);border:1px solid var(--card-border);border-radius:50px;cursor:pointer;font-size:.85rem;transition:all .3s}
.chapter-replay:hover{border-color:var(--accent);color:var(--text)}

/* Game Screen */
#game{max-width:700px;margin:0 auto;min-height:100vh;padding:1rem}
.game-header{display:flex;align-items:center;padding:1rem 0;border-bottom:1px solid var(--card-border);margin-bottom:1.5rem;gap:12px}
.game-back{background:none;border:none;color:var(--text2);font-size:1.3rem;cursor:pointer;padding:4px 8px}
.game-back:hover{color:var(--text)}
.game-title{font-size:1.1rem;font-weight:700;flex:1}
.game-progress-text{color:var(--text2);font-size:.85rem}

.progress-bar{display:flex;gap:6px;margin-bottom:1.5rem}
.prog-dot{flex:1;height:4px;border-radius:2px;background:var(--bg3);transition:all .3s}
.prog-dot.active{background:var(--accent);box-shadow:0 0 8px rgba(180,74,255,.4)}
.prog-dot.done{background:var(--success)}

.story-box{background:var(--bg3);border:1px solid var(--card-border);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem;animation:fadeIn .5s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(15px)}to{opacity:1;transform:translateY(0)}}
.story-box .label{color:var(--accent);font-size:.75rem;font-weight:700;margin-bottom:8px;text-transform:uppercase;letter-spacing:.15em}
.story-box p{color:var(--text2);line-height:1.8}

.puzzle-box{background:rgba(180,74,255,.05);border:1px solid rgba(180,74,255,.15);border-radius:16px;padding:1.5rem;margin-bottom:1.5rem;animation:fadeIn .5s ease}
.puzzle-label{color:var(--cyan);font-size:.8rem;font-weight:700;margin-bottom:12px;letter-spacing:.05em}
.puzzle-question{font-size:1rem;line-height:1.8;margin-bottom:1.2rem}

.cpq-mission{background:rgba(0,229,255,.05);border:1px solid rgba(0,229,255,.15);border-radius:12px;padding:1.2rem;margin:1rem 0}
.cpq-mission .mission-title{color:var(--cyan);font-size:.8rem;font-weight:700;margin-bottom:10px}
.cpq-steps{font-size:.9rem;color:var(--text2);line-height:2;padding-left:1.2rem}
.cpq-steps b{color:var(--text)}
.cpq-keyword-box{margin-top:12px;display:flex;align-items:center;gap:10px}
.cpq-keyword{display:inline-block;background:linear-gradient(135deg,var(--accent),var(--cyan));color:#000;padding:8px 20px;border-radius:50px;font-size:.9rem;font-weight:700;cursor:pointer;transition:all .2s}
.cpq-keyword:hover{transform:scale(1.03);box-shadow:0 4px 15px rgba(180,74,255,.3)}

.hint-btn{background:none;border:1px solid var(--text3);color:var(--text2);padding:8px 16px;border-radius:50px;font-size:.8rem;cursor:pointer;transition:all .2s;margin-bottom:1rem}
.hint-btn:hover{border-color:var(--accent);color:var(--accent)}
.hint-box{background:rgba(255,165,0,.08);border:1px solid rgba(255,165,0,.2);border-radius:10px;padding:12px 16px;font-size:.9rem;color:#f59e0b;margin-bottom:1rem}

.answer-area{display:flex;flex-direction:column;gap:10px}
.answer-area input{width:100%;padding:14px 18px;background:var(--bg3);border:1px solid var(--card-border);border-radius:12px;color:var(--text);font-size:1rem;font-family:inherit;outline:none;transition:border-color .3s}
.answer-area input:focus{border-color:var(--accent)}
.answer-area input::placeholder{color:var(--text3)}
.btn-submit{width:100%;padding:14px 28px;background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff;border:none;border-radius:12px;font-weight:700;cursor:pointer;transition:all .2s;white-space:nowrap;font-family:inherit;font-size:.95rem}
.btn-submit:hover{box-shadow:0 4px 15px rgba(180,74,255,.4)}
.btn-next{width:100%;padding:14px;background:linear-gradient(135deg,var(--accent),var(--cyan));color:#000;border:none;border-radius:50px;font-weight:700;cursor:pointer;transition:all .3s;font-size:1rem;font-family:inherit;margin-top:1rem}
.btn-next:hover{box-shadow:0 4px 20px rgba(180,74,255,.4);transform:translateY(-1px)}

.feedback{padding:14px 18px;border-radius:12px;margin-top:1rem;font-size:.95rem;animation:fadeIn .3s}
.feedback.correct{background:rgba(0,255,136,.1);color:var(--success);border:1px solid rgba(0,255,136,.2)}
.feedback.wrong{background:rgba(255,68,68,.1);color:var(--danger);border:1px solid rgba(255,68,68,.2)}

/* Cliffhanger */
.cliffhanger-box{background:linear-gradient(135deg,rgba(180,74,255,.08),rgba(0,229,255,.08));border:1px solid rgba(180,74,255,.25);border-radius:16px;padding:2rem;margin:1.5rem 0;text-align:center;animation:fadeIn .8s ease}
.cliffhanger-box .label{color:var(--cyan);font-size:.75rem;font-weight:700;margin-bottom:12px;letter-spacing:.2em}
.cliffhanger-box p{color:var(--text);line-height:2;font-size:1.05rem;font-style:italic}

/* Series Clear */
.series-clear-box{text-align:center;padding:2rem 0;animation:fadeIn .5s}
.series-clear-emoji{font-size:4rem;margin-bottom:1rem}
.series-clear-title{font-size:1.8rem;font-weight:900;background:linear-gradient(135deg,#fff,var(--accent),var(--cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:.5rem}
.series-clear-sub{color:var(--text2);margin-bottom:1.5rem}

/* Result */
#result{max-width:600px;margin:0 auto;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:2rem}
.result-card{text-align:center;width:100%}
.result-emoji{font-size:4rem;margin-bottom:1rem}
.result-title{font-size:2rem;font-weight:900;margin-bottom:.5rem;background:linear-gradient(135deg,#fff,var(--accent),var(--cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.result-sub{color:var(--text2);margin-bottom:2rem}
.result-grade{display:inline-block;font-size:1.5rem;font-weight:900;padding:10px 30px;border-radius:50px;background:linear-gradient(135deg,var(--accent),var(--cyan));color:#000;margin-bottom:2rem}
.result-stats{display:flex;justify-content:center;gap:20px;margin-bottom:2rem;flex-wrap:wrap}
.result-stat{background:var(--card);border:1px solid var(--card-border);border-radius:16px;padding:18px 24px;min-width:100px}
.result-stat-val{font-size:1.5rem;font-weight:900;color:var(--accent)}
.result-stat-label{font-size:.75rem;color:var(--text2);margin-top:4px}
.result-btns{display:flex;flex-direction:column;gap:10px;max-width:300px;margin:0 auto}
.btn-home{padding:14px;background:linear-gradient(135deg,var(--accent),var(--accent2));color:#fff;border:none;border-radius:50px;font-weight:700;cursor:pointer;font-size:1rem;font-family:inherit;transition:all .3s}
.btn-home:hover{box-shadow:0 4px 15px rgba(180,74,255,.4)}
.btn-share{padding:14px;background:transparent;border:1px solid var(--card-border);color:var(--text2);border-radius:50px;cursor:pointer;font-size:.9rem;font-family:inherit;transition:all .2s}
.btn-share:hover{border-color:var(--accent);color:var(--text)}

/* Loading */
.loading-screen{display:none;position:fixed;inset:0;background:var(--bg);z-index:1000;flex-direction:column;align-items:center;justify-content:center;gap:16px}
.loading-screen.active{display:flex}
.spinner{width:40px;height:40px;border:3px solid var(--bg3);border-top-color:var(--accent);border-radius:50%;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{color:var(--text2);font-size:.9rem}

/* Confetti */
.confetti-container{position:fixed;inset:0;pointer-events:none;z-index:999;overflow:hidden}
.confetti-piece{position:absolute;width:10px;height:10px;top:-20px;animation:confettiFall 3s ease-in forwards}
@keyframes confettiFall{0%{transform:translateY(0) rotate(0deg);opacity:1}100%{transform:translateY(100vh) rotate(720deg);opacity:0}}

@media(max-width:600px){
  .hero h1{letter-spacing:.05em}
  .stats-bar{gap:24px}
  .result-stats{gap:12px}
  .series-card{padding:1.3rem}
  .chapter-timeline{padding-left:28px}
}
</style>
</head>
<body>

<!-- â”€â”€â”€ í™ˆ â”€â”€â”€ -->
<div id="home">
  <div class="hero">
    <div class="particles" id="particles"></div>
    <h1>QUBE</h1>
    <p>í’€ì–´ë¼. íƒˆì¶œí•˜ë¼.</p>
    <button class="hero-cta" onclick="scrollToSeries()">ì‹œë¦¬ì¦ˆ ì„ íƒí•˜ê¸°</button>
    <div class="scroll-hint">â†“</div>
  </div>
  <div class="stats-bar">
    <div class="stat"><div class="stat-val" id="statCleared">0</div><div class="stat-label">í´ë¦¬ì–´</div></div>
    <div class="stat"><div class="stat-val" id="statGrade">ğŸ”°</div><div class="stat-label">ë“±ê¸‰</div></div>
    <div class="stat"><div class="stat-val" id="statStreak">0</div><div class="stat-label">ì‹œë¦¬ì¦ˆ</div></div>
  </div>
  <div class="series-section" id="series-section">
    <h2>ğŸ“– ë¯¸ìŠ¤í„°ë¦¬ ì‹œë¦¬ì¦ˆ</h2>
    <div class="series-progress-text" id="seriesProgressText"></div>
    <div id="seriesGrid"></div>
  </div>
</div>

<!-- â”€â”€â”€ ì±•í„° ì„ íƒ â”€â”€â”€ -->
<div id="chapters" class="hidden"></div>

<!-- â”€â”€â”€ ë¡œë”© â”€â”€â”€ -->
<div class="loading-screen" id="loadingScreen">
  <div class="spinner"></div>
  <div class="loading-text">ì§„ì… ì¤‘...</div>
</div>

<!-- â”€â”€â”€ ê²Œì„ â”€â”€â”€ -->
<div id="game" class="hidden">
  <div class="game-header">
    <button class="game-back" onclick="confirmExit()">â†</button>
    <div class="game-title" id="gameTitle"></div>
    <div class="game-progress-text" id="gameProgressText"></div>
  </div>
  <div class="progress-bar" id="progressBar"></div>
  <div id="gameContent"></div>
</div>

<!-- â”€â”€â”€ ê²°ê³¼ â”€â”€â”€ -->
<div id="result" class="hidden">
  <div class="result-card" id="resultContent"></div>
</div>

<script>
const API = 'https://qube-api.harpy922.workers.dev';

// â”€â”€â”€ ì‹œë¦¬ì¦ˆ & ì±•í„° ë°ì´í„° â”€â”€â”€
const SERIES = [
  {
    id: 'professor',
    title: 'ì‚¬ë¼ì§„ êµìˆ˜',
    icon: 'ğŸ”®',
    difficulty: 1,
    desc: 'ê³ ê³ í•™ êµìˆ˜ ê¹€ë™í˜„ì´ ë°œêµ´ í˜„ì¥ì—ì„œ ì‹¤ì¢…ëë‹¤. ë‚¨ì€ ê±´ ì•”í˜¸í™”ëœ ì—°êµ¬ë…¸íŠ¸ í•œ ê¶Œë¿.',
    chapters: [
      {
        id: 'ch1_study',
        title: 'Ch.1 â€” êµìˆ˜ì˜ ì„œì¬',
        desc: 'ì‹¤ì¢… 3ì¼ì§¸. ì„œì¬ì— ì¹¨ì…í•´ ë‹¨ì„œë¥¼ ì°¾ëŠ”ë‹¤.',
        time: '12ë¶„',
        intro: 'ê¹€ë™í˜„ êµìˆ˜ê°€ ì‚¬ë¼ì¡Œë‹¤.\n3ì¼ì§¸ ì—°ë½ ë‘ì ˆ. ê²½ì°°ì€ "ìë°œì  ì ì "ì´ë¼ í–ˆì§€ë§Œ, ë‹¹ì‹ ì€ ë¯¿ì§€ ì•Šì•˜ë‹¤.\në§ˆìŠ¤í„°í‚¤ë¡œ ì„œì¬ì— ë“¤ì–´ì„  ìˆœê°„, ë“± ë’¤ì—ì„œ ë¬¸ì´ ì ê²¼ë‹¤.\ní¬ë¯¸í•œ ìŠ¤íƒ ë“œ ë¶ˆë¹› ì•„ë˜, ê¸‰í•˜ê²Œ ì°¢ê¸´ ì„œë¥˜ì™€ ì“°ëŸ¬ì§„ ì»¤í”¼ì”.\nêµìˆ˜ëŠ” ë­”ê°€ë¥¼ ìˆ¨ê¸°ë‹¤ ì«“ê¸´ ê²ƒì´ë‹¤.',
        puzzles: [
          { type:'general', title:'ğŸ“‹ í¼ì¦ 1: ì±…ìƒ ìœ„ì˜ ì•”í˜¸ ë©”ëª¨',
            story: 'ì±…ìƒ ìœ„, í”¼ ë¬»ì€ í¬ìŠ¤íŠ¸ì‡ í•˜ë‚˜. êµìˆ˜ì˜ ë–¨ë¦¬ëŠ” í•„ì²´. ì¢Œí‘œ ì•”í˜¸ë‹¤.',
            question: 'ê²©ìì—ì„œ ì¢Œí‘œë¥¼ ì½ì–´ ë©”ì‹œì§€ë¥¼ ì™„ì„±í•˜ë¼.\n\n<b>â”Œâ”€â”€â”¬â”€â”€â”¬â”€â”€â”¬â”€â”€â”\nâ”‚ ì„œ â”‚ ë â”‚ ì„ â”‚ ê¸ˆ â”‚\nâ”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤\nâ”‚ ì—´ â”‚ ì–´ â”‚ ê³  â”‚ ë¼ â”‚\nâ”œâ”€â”€â”¼â”€â”€â”¼â”€â”€â”¼â”€â”€â”¤\nâ”‚ ë²½ â”‚ í™• â”‚ ì¸ â”‚ í•´ â”‚\nâ””â”€â”€â”´â”€â”€â”´â”€â”€â”´â”€â”€â”˜</b>\n\nì¢Œí‘œ: <b>(1,1) (1,2) (2,1) (2,2) (2,3)</b>\n(í–‰,ì—´ ìˆœì„œ)\n\në‹¤ì„¯ ê¸€ìë¥¼ ì´ì–´ì„œ ì…ë ¥í•˜ì‹œì˜¤.',
            hint: '(1,1)=ì„œ, (1,2)=ë, (2,1)=ì—´, (2,2)=ì–´, (2,3)=ê³ ',
            validate: function(i){return i.replace(/\s/g,'') === 'ì„œëì—´ì–´ê³ '} },
          { type:'general', title:'ğŸ“¦ í¼ì¦ 2: ì„œë ì† íƒë°° ì˜ìˆ˜ì¦',
            story: 'ì„œëì´ ì—´ë ¸ë‹¤. ì•ˆì—ëŠ” íƒë°° ì˜ìˆ˜ì¦ í•œ ì¥. ì‹¤ì¢… ì´í‹€ ì „, ë‚¯ì„  ì£¼ì†Œë¡œ ë³´ë‚¸ í™”ë¬¼.\nêµìˆ˜ê°€ ë¹¨ê°„ íœìœ¼ë¡œ ë°‘ì¤„ ê·¸ì€ ë¶€ë¶„: "ë°°ì†¡ë£Œê°€ ë‹¨ì„œë‹¤."',
            question: 'íƒë°° ì˜ìˆ˜ì¦ì˜ ìµœì¢… ë°°ì†¡ë£Œë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>ê¸°ë³¸ë£Œ: 3,000ì›\nê±°ë¦¬í• ì¦(5kmì´ˆê³¼): 2,000ì›\në¬´ê²Œí• ì¦(5kgì´ˆê³¼): 1,500ì›\ní• ì¸(íšŒì›): -500ì›</b>\n\nìµœì¢… ë°°ì†¡ë£ŒëŠ”?',
            hint: '3,000 + 2,000 + 1,500 - 500 = ?',
            validate: function(i){return i.replace(/[^\d]/g,'') === '6000'} },
          { type:'general', title:'ğŸ”¢ í¼ì¦ 3: ë²½ ì†ì˜ ê¸ˆê³ ',
            story: 'ì˜ìˆ˜ì¦ ë’·ë©´: "ë²½ì„ í™•ì¸í•˜ë¼." ì±…ì¥ ì„¸ ë²ˆì§¸ ì¹¸ ë’¤ì— ìˆ¨ê²¨ì§„ ê¸ˆê³ .\nìœ„ì— ë„¤ ê¶Œì˜ ì±…ì´ ì˜ë„ì ìœ¼ë¡œ ë°°ì¹˜ë˜ì–´ ìˆë‹¤.',
            question: 'ê° ì±… <b>ì œëª©</b> ì†ì— ìˆ¨ê²¨ì§„ ìˆ«ìë¥¼ ìˆœì„œëŒ€ë¡œ ë‚˜ì—´í•˜ë©´?\n\nğŸ“• ë¡œë§ˆì˜ <b>ì¼ê³±</b> ì–¸ë•\nğŸ“— ì´ì§‘íŠ¸ ì œ<b>5</b>ì™•ì¡°\nğŸ“˜ ê·¸ë¦¬ìŠ¤ <b>12</b>ì‹ \nğŸ“™ í•œêµ­ì˜ <b>ì‚¼êµ­</b>ì‹œëŒ€\n\n(ìˆ«ìë¥¼ ì•„ë¼ë¹„ì•„ ìˆ«ìë¡œ ë³€í™˜í•˜ì—¬ ì´ì–´ì„œ ì…ë ¥)',
            hint: 'ì¼ê³±=7, 5=5, 12=12, ì‚¼êµ­=3',
            validate: function(i){return i.replace(/\s/g,'') === '75123'} },
          { type:'general', title:'ğŸ““ í¼ì¦ 4: ê¸ˆê³  ì† ìˆ˜ì²©',
            story: 'ê¸ˆê³ ê°€ ì—´ë ¸ë‹¤. "PRIVATE" ê°ì¸ëœ ê°€ì£½ ìˆ˜ì²©.\nêµìˆ˜ëŠ” ë­”ê°€ë¥¼ ì²´ê³„ì ìœ¼ë¡œ ì¶”ì í•˜ê³  ìˆì—ˆë‹¤. ë§ˆì§€ë§‰ í˜ì´ì§€ì— ì•ŒíŒŒë²³ ì•”í˜¸.',
            question: 'ì•ŒíŒŒë²³ ì•”í˜¸ë¥¼ í•´ë…í•˜ë¼.\n\n<b>A=1, B=2, C=3, D=4, ..., O=15, ..., R=18</b>\n\nDOOR = D(4) + O(15) + O(15) + R(18) = ?',
            hint: '4 + 15 + 15 + 18 = ?',
            validate: function(i){return i.trim() === '52'} },
          { type:'cpq', cpqIndex:0,
            story: 'ìˆ˜ì²© ë§ˆì§€ë§‰ ì¥ì— ë¹¨ê°„ ë™ê·¸ë¼ë¯¸ ì¹œ ì£¼ì†Œ.\n"ì—¬ê¸°ê°€ í•µì‹¬ì´ë‹¤." êµìˆ˜ê°€ ì‚¬ë¼ì§€ê¸° ì§ì „, ë§ˆì§€ë§‰ìœ¼ë¡œ í–¥í•˜ë ¤ë˜ ì¥ì†Œ.',
            storyAfter: 'ì½”ë“œê°€ ë§ì•˜ë‹¤. ìˆ˜ì²© ë’·í‘œì§€ ì•ˆìª½, êµìˆ˜ì˜ ë§ˆì§€ë§‰ ë©”ëª¨ê°€ ë“œëŸ¬ë‚¬ë‹¤.' }
        ],
        cliffhanger: 'ìˆ˜ì²© ë’·í‘œì§€ë¥¼ ë²—ê¸°ì ì ‘íŒ ì¢…ì´ê°€ ë–¨ì–´ì¡Œë‹¤.\në–¨ë¦¬ëŠ” ì†ìœ¼ë¡œ í¼ì³¤ë‹¤. êµìˆ˜ì˜ í•„ì²´.\n\n"ê·¸ë“¤ì´ ë‚˜ë¥¼ ì°¾ê³  ìˆë‹¤. ì—°êµ¬ ìƒ˜í”Œì€ í™”ë¬¼ì„ ì— ì‹¤ì—ˆë‹¤."\n"ì•„ë¦¬ì•„í˜¸... ì¸ì²œí•­ 2ë²ˆ ì„ ì°©ì¥..."\n\nêµìˆ˜ëŠ” ì—¬ê¸°ì„œ ë°°ë¥¼ íƒ”ë‹¤.\nê·¸ë¦¬ê³  ì‚¬ë¼ì¡Œë‹¤.'
      },
      {
        id: 'ch2_ship',
        title: 'Ch.2 â€” í™”ë¬¼ì„  ì•„ë¦¬ì•„í˜¸',
        desc: 'êµìˆ˜ê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ íƒ‘ìŠ¹í•œ ìœ ë ¹ í™”ë¬¼ì„ ì— ì ì…í•œë‹¤.',
        time: '14ë¶„',
        intro: 'ì¸ì²œí•­ 2ë²ˆ ì„ ì°©ì¥.\në…¹ìŠ¨ í™”ë¬¼ì„  "ì•„ë¦¬ì•„í˜¸"ê°€ ì•ˆê°œ ì†ì— ì •ë°•í•´ ìˆë‹¤.\nì„ ì› 12ëª…ì´ íƒ€ê³  ìˆì—ˆë‹¤. ì§€ê¸ˆì€ ì•„ë¬´ë„ ì—†ë‹¤. êµ¬ëª…ë³´íŠ¸ë„, ì†Œì§€í’ˆë„ ê·¸ëŒ€ë¡œì¸ ì±„.\në‹¹ì‹ ì´ ê°‘íŒì— ì˜¬ë¼ì„  ìˆœê°„, í•´ì¹˜ê°€ ë‹«í˜”ë‹¤.\në¹„ìƒë“±ë§Œ ê¹œë¹¡ì´ê³ , ì–´ë”˜ê°€ì—ì„œ ê¸ˆì†ì´ ì‚ê±±ê±°ë¦°ë‹¤.',
        puzzles: [
          { type:'general', title:'ğŸ§­ í¼ì¦ 1: í•­í•´ ì¼ì§€ì˜ ë§ˆì§€ë§‰ ê¸°ë¡',
            story: 'ì„ ì¥ì‹¤. í•­í•´ ì¼ì§€ ë§ˆì§€ë§‰ ê¸°ë¡:\n"2ì›” 11ì¼ 23:47 â€” ë ˆì´ë” ì´ìƒ ë°˜ì‘. ì†Œë¦¬ë¥¼ ë“¤ì—ˆë‹¤. í™•ì¸í•˜ëŸ¬ ê°„ë‹¤."\nì—¬ê¸°ì„œ ëŠê¸´ë‹¤.',
            question: 'ì„ ì¥ì‹¤ ê¸ˆê³  ìœ„ì— ì±… ì„¸ ê¶Œ, ê°ê° í¬ìŠ¤íŠ¸ì‡ì´ ê½‚í˜€ìˆë‹¤.\n\n<b>ğŸ“• "í•´ì–‘ë²• ê°œë¡ " â†’ í‘œì‹œëœ ë‹¨ì–´: "ëŒ€í•œë¯¼êµ­"\nğŸ“— "í•­í•´ìˆ ì˜ ì—­ì‚¬" â†’ í‘œì‹œëœ ë‹¨ì–´: "ë‚˜ì¹¨ë°˜"\nğŸ“˜ "ì„ ë°• êµ¬ì¡°í•™" â†’ í‘œì‹œëœ ë‹¨ì–´: "ìš©ê³¨"</b>\n\nê¸ˆê³  ë©”ëª¨: "ê° ë‹¨ì–´ì˜ ê¸€ì ìˆ˜ê°€ ë¹„ë°€ë²ˆí˜¸ë‹¤."\nì„¸ ìˆ«ìë¥¼ ì´ì–´ì„œ ì…ë ¥í•˜ì‹œì˜¤.',
            hint: 'ëŒ€í•œë¯¼êµ­=4, ë‚˜ì¹¨ë°˜=3, ìš©ê³¨=2',
            validate: function(i){return i.replace(/\s/g,'') === '432'} },
          { type:'general', title:'ğŸ“¦ í¼ì¦ 2: í™”ë¬¼ ì í•˜ ëª©ë¡',
            story: 'ê¸ˆê³  ì•ˆì— "HELP" í•œ ë‹¨ì–´ì™€ ì í•˜ ëª©ë¡.\në¹¨ê°„ ì¤„ ê·¸ì€ í•­ëª©: "íŠ¹ìˆ˜ í™”ë¬¼ #7 â€” ë°œì†¡ì§€ í™•ì¸ ìš”ë§."',
            question: 'í™”ë¬¼ #7ì˜ ë¶€í”¼ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>ê¸¸ì´: 120cm\ní­: 80cm\në†’ì´: 50cm</b>\n\në¶€í”¼ = ê¸¸ì´ Ã— í­ Ã— ë†’ì´ = ? cmÂ³',
            hint: '120 Ã— 80 Ã— 50 = ?',
            validate: function(i){return i.replace(/[^\d]/g,'') === '480000'} },
          { type:'general', title:'âš“ í¼ì¦ 3: ê¸°ê´€ì‹¤ì˜ ì´ì§„ë²•',
            story: 'ê¸°ê´€ì‹¤. ì—”ì§„ì´ ë©ˆì¶°ìˆë‹¤. ì—°ë£ŒëŠ” ì¶©ë¶„í•œë° ëˆ„êµ°ê°€ ì¼ë¶€ëŸ¬ ì •ì§€ì‹œì¼°ë‹¤.\në°°ì „ë°˜ì— 12ê°œì˜ ìŠ¤ìœ„ì¹˜ê°€ ìˆë‹¤.',
            question: 'ë°°ì „ë°˜ì˜ ì´ì§„ë²•ì„ í•´ë…í•˜ë¼.\n\n<b>ìœ„ì•„ë˜ì•„ë˜ìœ„ | ì•„ë˜ìœ„ì•„ë˜ì•„ë˜ | ì•„ë˜ì•„ë˜ìœ„ìœ„</b>\n= 1001 | 0100 | 0011\n\nê° 4ìë¦¬ ì´ì§„ìˆ˜ë¥¼ ì‹­ì§„ìˆ˜ë¡œ ë³€í™˜í•˜ë©´?\n(ì„¸ ìˆ«ìë¥¼ ì´ì–´ì„œ ì…ë ¥)',
            hint: '1001=9, 0100=4, 0011=3',
            validate: function(i){return i.replace(/\s/g,'') === '943'} },
          { type:'general', title:'ğŸ“» í¼ì¦ 4: ë¬´ì „ê¸° SOS ì‹ í˜¸',
            story: 'ê¸°ê´€ì¥ ë°•ì² ìˆ˜ì˜ ë…¸íŠ¸.\n"ì„ ì¥ì´ í™”ë¬¼ #7ì„ ì—´ì—ˆë‹¤. ê·¸ ì•ˆì— ìˆë˜ ê±´... ì—°êµ¬ ìƒ˜í”Œì´ ì•„ë‹ˆì—ˆë‹¤."',
            question: 'SOS ëª¨ìŠ¤ ë¶€í˜¸ì˜ ì´ ì‹ í˜¸ ê°œìˆ˜ë¥¼ ì„¸ì–´ë¼.\n\n<b>S = ... (ì  3ê°œ)\nO = --- (ì„  3ê°œ)\nS = ... (ì  3ê°œ)</b>\n\nì ê³¼ ì„ ì„ ëª¨ë‘ í•©ì³ì„œ ì´ ëª‡ ê°œ?',
            hint: '3 + 3 + 3 = ?',
            validate: function(i){return i.trim() === '9'} },
          { type:'cpq', cpqIndex:0,
            story: 'ê¸°ê´€ì¥ì˜ ë…¸íŠ¸ ë§ˆì§€ë§‰ í˜ì´ì§€.\n"í™”ë¬¼ #7ì˜ ì§„ì§œ ë°œì†¡ì§€ë¥¼ ì°¾ì•˜ë‹¤. ì´ ì£¼ì†Œë‹¤."',
            storyAfter: 'ë§ì•˜ë‹¤. ê¸°ê´€ì¥ì˜ ë§ˆì§€ë§‰ ê¸°ë¡ì´ í•´ë…ëë‹¤.' }
        ],
        cliffhanger: 'ê¸°ê´€ì¥ì˜ ë§ˆì§€ë§‰ ê¸°ë¡.\n\n"í™”ë¬¼ #7 ì•ˆì— ë“  ê±´ êµìˆ˜ì˜ ì—°êµ¬ ìƒ˜í”Œì´ ì•„ë‹ˆì—ˆë‹¤.\nì¸ì²´ ì¡°ì§ì´ì—ˆë‹¤."\n\nì í•˜ ëª©ë¡ ë’·ë©´, ë°°ì†¡ì§€ ì£¼ì†Œê°€ ì í˜€ ìˆë‹¤.\n\n"ê·¸ëœë“œ íŒŒí¬ í˜¸í…” 1408í˜¸ â€” VIP ì „ìš© ë°°ì†¡"\n\nêµìˆ˜ëŠ” ì´ê±¸ ì•Œê³  ìˆì—ˆë‹¤. ê·¸ë˜ì„œ ì«“ê¸´ ê²ƒì´ë‹¤.'
      },
      {
        id: 'ch3_hotel',
        title: 'Ch.3 â€” í˜¸í…” ìŠ¤ìœ„íŠ¸ë£¸',
        desc: '5ì„±ê¸‰ í˜¸í…” 1408í˜¸. êµìˆ˜ê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ëª©ê²©ëœ ê³³.',
        time: '15ë¶„',
        intro: 'ê·¸ëœë“œ íŒŒí¬ í˜¸í…”. ë¡œë¹„ì˜ ìƒ¹ë“¤ë¦¬ì—ê°€ ì°¨ê°‘ê²Œ ë¹›ë‚œë‹¤.\n1408í˜¸. VIP ì „ìš© ìŠ¤ìœ„íŠ¸ë£¸. êµìˆ˜ê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ëª©ê²©ëœ ê³³.\nì¹´ë“œí‚¤ë¥¼ ëŒ€ì ë¬¸ì´ ì—´ë ¸ë‹¤. ì•ˆì— ë“¤ì–´ì„œëŠ” ìˆœê°„, ìë™ ì ê¸ˆ.\nì¹¨ëŒ€ëŠ” ì •ëˆë˜ì–´ ìˆì§€ë§Œ, ìš•ì‹¤ì—ì„œ í¬ë¯¸í•œ ë¬¼ì†Œë¦¬ê°€ ë“¤ë¦°ë‹¤.\nëˆ„êµ°ê°€ ì—¬ê¸° ìˆì—ˆë‹¤. ì•„ì£¼ ìµœê·¼ê¹Œì§€.',
        puzzles: [
          { type:'general', title:'ğŸ”‘ í¼ì¦ 1: ë…¸íŠ¸ë¶ì˜ ì´ëª¨ì§€ ì•”í˜¸',
            story: 'ì±…ìƒ ìœ„ ë…¸íŠ¸ë¶ì´ ì—´ë ¤ìˆë‹¤. ì ê¸ˆ í™”ë©´ì— ì´ëª¨ì§€ ìˆ˜ì‹ì´ ê¹œë¹¡ì¸ë‹¤.',
            question: 'ë…¸íŠ¸ë¶ ë¹„ë°€ë²ˆí˜¸ë¥¼ í’€ì–´ë¼.\n\n<b>ğŸ¨ + ğŸ¨ = 28\nğŸ”‘ Ã— ğŸ”‘ = 16\nğŸ¨ - ğŸ”‘ = ?</b>',
            hint: 'ğŸ¨=14, ğŸ”‘=4, 14-4=?',
            validate: function(i){return i.trim() === '10'} },
          { type:'general', title:'ğŸ’» í¼ì¦ 2: ê²€ìƒ‰ ê¸°ë¡ ë¶„ì„',
            story: 'ë…¸íŠ¸ë¶ì´ ì—´ë ¸ë‹¤. ë§ˆì§€ë§‰ ê²€ìƒ‰ì€ ì‚¬ë¼ì§€ê¸° 17ë¶„ ì „.\në¹„ì¦ˆë‹ˆìŠ¤ì™€ ë¬´ê´€í•œ ì´ìƒí•œ í‚¤ì›Œë“œë“¤.',
            question: 'ê²€ìƒ‰ ê¸°ë¡ì—ì„œ ìˆ«ìë¥¼ ì°¾ì•„ ë”í•˜ë¼.\n\n<b>"M&A ì‹¤ì‚¬ ì ˆì°¨" â†’ ìˆ«ì ì—†ìŒ\n"ê³„ì•½ì„œ ê²€í†  ìš”ë ¹" â†’ ìˆ«ì ì—†ìŒ\n"í˜¸í…” 1408í˜¸ ë¹„ë°€" â†’ 1408\n"ìˆ«ì 7ì˜ ì˜ë¯¸" â†’ 7</b>\n\n1408 + 7 = ?',
            hint: '1408 + 7 = ?',
            validate: function(i){return i.trim() === '1415'} },
          { type:'general', title:'ğŸª í¼ì¦ 3: ìš•ì‹¤ ê±°ìš¸ì˜ ë©”ì‹œì§€',
            story: 'ë©”ëª¨ ì•±ì— ëˆ„êµ°ê°€ ì ì—ˆë‹¤. êµìˆ˜ì˜ ê¸€ì”¨ê°€ ì•„ë‹ˆë‹¤.\n"ê±°ìš¸ ë’¤ì— ì§„ì‹¤ì´ ìˆë‹¤."\nì˜¨ìˆ˜ë¥¼ í‹€ì ê¹€ ì„œë¦° ê±°ìš¸ì— ìˆ«ìê°€ ë– ì˜¬ëë‹¤.',
            question: 'ê±°ìš¸ì— ë¹„ì¹œ ìˆ«ì: <b>5765</b>\n\nê±°ìš¸ì´ë¯€ë¡œ ì¢Œìš°ê°€ ë°˜ì „ëœë‹¤.\nì‹¤ì œ ìˆ«ì(ìˆœì„œê°€ ë’¤ì§‘íŒ)ë¥¼ ì…ë ¥í•˜ë¼.',
            hint: '5765ë¥¼ ë’¤ì§‘ìœ¼ë©´ 5675',
            validate: function(i){return i.trim() === '5675'} },
          { type:'general', title:'ğŸ“… í¼ì¦ 4: ë¹„ë°€ ê¸ˆê³ ì˜ ì¼ì •í‘œ',
            story: 'ìš•ì‹¤ íƒ€ì¼ ë°‘ì— ê¸ˆê³ . í˜¸í…” ë¹„í’ˆì´ ì•„ë‹ˆë‹¤. ëˆ„ê°€ ì„¤ì¹˜í•œ ê±°ì§€?\nì•ˆì— êµìˆ˜ì˜ ë¹„ë°€ ì¼ì •í‘œê°€ ìˆë‹¤.',
            question: 'ì¼ì •í‘œì˜ ì´ ì°¸ì„ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>09:00 Aì‚¬ ë¯¸íŒ…: 3ëª…\n14:00 Bì‚¬ ê²€í† : 2ëª…\n16:30 Cì‚¬ í˜‘ì˜: 4ëª…\n19:00 ì €ë… ì‹ì‚¬: 1ëª…</b>\n\n3 + 2 + 4 + 1 = ?',
            hint: '3 + 2 + 4 + 1 = ?',
            validate: function(i){return i.trim() === '10'} },
          { type:'cpq', cpqIndex:0,
            story: 'ê¸ˆê³  ì•ˆ ë´‰íˆ¬. êµìˆ˜ì˜ í¸ì§€.\n"ì´ í˜¸í…”ì€ ê±°ì ì´ë‹¤. ì§„ì§œ ëª©ì ì§€ì˜ ìœ„ì¹˜ë¥¼ ë‚¨ê¸´ë‹¤."',
            storyAfter: 'í¸ì§€ì˜ ë§ˆì§€ë§‰ ì¤„ì´ ë“œëŸ¬ë‚¬ë‹¤.' }
        ],
        cliffhanger: 'í¸ì§€ì˜ ë§ˆì§€ë§‰ ì¤„.\n\n"ë‚˜ëŠ” ë„ë§ì¹œ ê²Œ ì•„ë‹ˆë‹¤. ê°ê¸ˆë‹¹í–ˆë‹¤."\n"ì¹¨ëŒ€ í—¤ë“œë³´ë“œ ë’¤ì— ë¹„ë°€ í†µë¡œê°€ ìˆë‹¤. í•˜ì§€ë§Œ ì—´ì§€ ë§ˆë¼."\n"ê·¸ë“¤ì´ ê¸°ë‹¤ë¦¬ê³  ìˆë‹¤."\n\ní—¤ë“œë³´ë“œë¥¼ ë°€ì ì°¨ê°€ìš´ ë°”ëŒì´ ë¶ˆì–´ì™”ë‹¤.\ní†µë¡œ ë²½ì— ì‚¬ì§„ í•œ ì¥ì´ ë¶™ì–´ìˆë‹¤.\nêµìˆ˜ì™€ í•¨ê»˜ ì°íŒ ë‚¨ì â€” ë§ˆìˆ ì‚¬ ìµœí˜„ìš°.\n\nì‚¬ì§„ ë’·ë©´: "ê·¸ë„ ì‚¬ë¼ì¡Œë‹¤. ìš°ë¦¬ëŠ” ê°™ì€ ê²ƒì„ ë°œê²¬í–ˆë‹¤."'
      }
    ]
  },
  {
    id: 'magician',
    title: 'ë§ˆìˆ ì‚¬ì˜ ìœ ì‚°',
    icon: 'ğŸ­',
    difficulty: 2,
    desc: 'ì „ì„¤ì˜ ë§ˆìˆ ì‚¬ ìµœí˜„ìš°ê°€ ê³µì—° ì¤‘ ì‚¬ë¼ì¡Œë‹¤. ìœ ì–¸ì¥ì—ëŠ” "ë§ˆì§€ë§‰ íŠ¸ë¦­ì„ í’€ì–´ë¼"ê³ ë§Œ ì í˜€ìˆë‹¤.',
    chapters: [
      {
        id: 'ch1_magic',
        title: 'Ch.1 â€” ë§ˆìˆ ì‚¬ì˜ ë¹„ë°€ ë°©',
        desc: 'ìµœí˜„ìš°ì˜ ê°œì¸ ì—°ìŠµì‹¤. ë¬´ëŒ€ì¥ì¹˜ì™€ ê±°ìš¸ë¡œ ê°€ë“í•œ ë°©.',
        time: '12ë¶„',
        intro: 'ë§ˆìˆ ì‚¬ ìµœí˜„ìš°. "ëŒ€íƒˆì¶œ" ê³µì—° ì¤‘ ì‚¬ë¼ì¡Œë‹¤.\nì¼ì£¼ì¼ì§¸ í–‰ë°©ë¶ˆëª…. ê²½ì°°ì€ "ìì‘ê·¹"ì´ë¼ ê²°ë¡  ë‚´ë ¸ë‹¤.\ní•˜ì§€ë§Œ êµìˆ˜ì˜ ì‚¬ì§„ì´ ëª¨ë“  ê±¸ ë°”ê¿¨ë‹¤.\nê·¹ì¥ ë’¤í¸ ë¹„ë°€ ë°©ì— ì ì…í–ˆì§€ë§Œ, ë§ˆìˆ  ì¥ì¹˜ê°€ ì‘ë™í•˜ë©° ë¬¸ì´ ë´‰ì‡„ëë‹¤.\nì˜¤ë¥´ê³¨ì´ ìš¸ë¦°ë‹¤. ìµœí˜„ìš°ì˜ ëª©ì†Œë¦¬: "ì§„ì§œ íƒì •ì´ë¼ë©´ ì´ê²ƒì„ í’€ì–´ë¼."',
        puzzles: [
          { type:'general', title:'ğŸƒ í¼ì¦ 1: ë§ˆìˆ ì‚¬ì˜ ì¹´ë“œ íŠ¸ë¦­',
            story: 'ë²¨ë²³ í…Œì´ë¸” ìœ„, ì¹´ë“œê°€ íŒ¨í„´ìœ¼ë¡œ í¼ì³ì ¸ ìˆë‹¤.\në©”ëª¨: "ë‚´ ê°€ì¥ ì¢‹ì•„í•˜ëŠ” ë§ˆìˆ  â€” ìˆ˜í•™ì˜ ë§ˆë²•."',
            question: 'ì¹´ë“œ íŒ¨í„´ì„ ë¶„ì„í•˜ë¼.\n\n<b>â™¥2 â™¥4 â™¥6 â™¥8 â™¥?</b> â† +2ì”©\n<b>â™¦1 â™¦3 â™¦5 â™¦7 â™¦?</b> â† +2ì”©\n<b>â™£3 â™£6 â™£9 â™£12 â™£?</b> â† +3ì”©\n\nê° ì¤„ì˜ ?ì— ë“¤ì–´ê°ˆ ìˆ«ìë¥¼ ì´ì–´ì„œ ì…ë ¥í•˜ì‹œì˜¤.',
            hint: 'â™¥: 10, â™¦: 9, â™£: 15',
            validate: function(i){return i.replace(/\s/g,'') === '10915'} },
          { type:'general', title:'ğŸ“” í¼ì¦ 2: ë‹¤ì´ì–´ë¦¬ì˜ ê³µì—° ê¸°ë¡',
            story: 'ê¸ˆê³  ì•ˆ ë‹¤ì´ì–´ë¦¬.\n"ê·¸ë“¤ì´ ì«“ê³  ìˆë‹¤. ë‚´ê°€ ë°œê²¬í•œ ë¹„ë°€ ë•Œë¬¸ì´ë‹¤."',
            question: 'ì´ ê³µì—° íšŸìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>1ì›”: 8íšŒ\n2ì›”: 12íšŒ\n3ì›”: 6íšŒ\n4ì›”: 15íšŒ\n5ì›”: 9íšŒ</b>\n\n8 + 12 + 6 + 15 + 9 = ?',
            hint: '8 + 12 + 6 + 15 + 9 = ?',
            validate: function(i){return i.trim() === '50'} },
          { type:'general', title:'ğŸª í¼ì¦ 3: ë§ˆë²•ì˜ ê±°ìš¸ LED',
            story: '"ë§ˆì§€ë§‰ ë‹¨ì„œëŠ” ê±°ìš¸ ì†ì—."\në²½ë©´ì˜ ë§ˆìˆ  ê±°ìš¸ì— ì†ì„ ëŒ€ì, LED íŒ¨í„´ì´ ë– ì˜¬ëë‹¤.',
            question: 'LED íŒ¨í„´ì—ì„œ ê²€ì€ ì (â—)ì˜ ì´ ê°œìˆ˜ë¥¼ ì„¸ì–´ë¼.\n\n<b>â— â—‹ â— â—‹ â—</b> â† 3ê°œ\n<b>â—‹ â— â—‹ â— â—‹</b> â† 2ê°œ\n<b>â— â—‹ â—‹ â—‹ â—</b> â† 2ê°œ\n<b>â—‹ â— â—‹ â— â—‹</b> â† 2ê°œ\n<b>â— â—‹ â— â—‹ â—‹</b> â† 2ê°œ\n\nì´ â—ì˜ ê°œìˆ˜ëŠ”?',
            hint: '3 + 2 + 2 + 2 + 2 = ?',
            validate: function(i){return i.trim() === '11'} },
          { type:'general', title:'ğŸ© í¼ì¦ 4: ë§ˆìˆ  ë„êµ¬ ëª©ë¡',
            story: 'ê±°ìš¸ì´ íšŒì „í•œë‹¤. ë’¤í¸ ì„œëì— ë§ˆìˆ  ë„êµ¬ ëª©ë¡ê³¼ í•¨ê»˜ ì˜¤ë˜ëœ ì‚¬ì§„.\nìµœí˜„ìš°ì™€ êµìˆ˜ ê¹€ë™í˜„, ê·¸ë¦¬ê³  ë˜ í•œ ëª…. ì–¼êµ´ì´ ì§€ì›Œì ¸ ìˆë‹¤.',
            question: 'ë§ˆìˆ  ë„êµ¬ ì´ ê°œìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>ì‹¤í¬ ìŠ¤ì¹´í”„: 7ê°œ\níŠ¸ëŸ¼í”„ ì¹´ë“œ: 12ë²Œ\në§ˆìˆ  ì§€íŒ¡ì´: 3ê°œ\nê±°ìš¸: 5ê°œ\në™ì „: 20ê°œ</b>\n\n7 + 12 + 3 + 5 + 20 = ?',
            hint: '7 + 12 + 3 + 5 + 20 = ?',
            validate: function(i){return i.trim() === '47'} },
          { type:'cpq', cpqIndex:0,
            story: '"ëŒ€íƒˆì¶œì€ ê³µì—°ì´ ì•„ë‹ˆì—ˆë‹¤."\nìµœí˜„ìš°ê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ í–¥í•˜ë ¤ë˜ ì¥ì†Œì˜ ë‹¨ì„œ.',
            storyAfter: 'ë„êµ¬í•¨ ì´ì¤‘ë°”ë‹¥ ì•„ë˜, ë´‰íˆ¬ í•˜ë‚˜ê°€ ë‚˜ì™”ë‹¤.' }
        ],
        cliffhanger: 'ë´‰íˆ¬ ì•ˆì—ëŠ” ë¹›ë°”ëœ ì¡¸ì—…ì•¨ë²” í•œ í˜ì´ì§€.\nì„¸ì¢…ê³ ë“±í•™êµ 3í•™ë…„ 2ë°˜, 1994ë…„.\n\nì„¸ ëª…ì—ê²Œ ë™ê·¸ë¼ë¯¸ê°€ ì³ì ¸ ìˆë‹¤.\nê¹€ë™í˜„. ìµœí˜„ìš°. ê·¸ë¦¬ê³  ì„¸ ë²ˆì§¸ ì‚¬ëŒ â€” ì´ë¦„ì´ ê¹Œë§£ê²Œ ì§€ì›Œì ¸ ìˆë‹¤.\n\nì•¨ë²” ì—¬ë°±ì— ìµœí˜„ìš°ì˜ ê¸€ì”¨:\n"ìš°ë¦¬ ì…‹ì€ ê°™ì€ ê±¸ ë´¤ë‹¤. ê·¸ë‚  ë°¤, í•™êµì—ì„œ."\n\n1994ë…„ ì„¸ì¢…ê³ . í™”ì¬ë¡œ íêµëœ ë°”ë¡œ ê·¸ í•™êµë‹¤.'
      },
      {
        id: 'ch2_school',
        title: 'Ch.2 â€” ì•¼ê°„ í•™êµ',
        desc: '30ë…„ ì „ í™”ì¬ë¡œ íêµëœ ì„¸ì¢…ê³ . ê·¸ë‚  ë°¤ì˜ ì§„ì‹¤ì„ íŒŒí—¤ì¹œë‹¤.',
        time: '14ë¶„',
        intro: 'ì„¸ì¢…ê³ ë“±í•™êµ. 30ë…„ê°„ ë°©ì¹˜ëœ íêµ.\nì² ì¡°ë§ì„ ë„˜ì–´ ì •ë¬¸ì— ë“¤ì–´ì„°ë‹¤. ìœ ë¦¬ì°½ì€ ê¹¨ì ¸ ìˆê³ , ë³µë„ì— ë‚™ì„œê°€ ê°€ë“í•˜ë‹¤.\n3í•™ë…„ 2ë°˜ êµì‹¤. ì¹ íŒì— ëˆ„êµ°ê°€ ìµœê·¼ì— ì ì–´ë†“ì€ ê¸€ì”¨.\n"ì—¬ê¸°ì„œ ì‹œì‘ëë‹¤."\në¬¸ì´ ì•ˆì—ì„œ ì ê²¼ë‹¤. ë¹„ìƒë“±ë§Œ ê¹œë¹¡ì´ëŠ” êµì‹¤. 30ë…„ ì „ì˜ ë©”ì•„ë¦¬ê°€ ë“¤ë¦°ë‹¤.',
        puzzles: [
          { type:'general', title:'ğŸ“š í¼ì¦ 1: ì‚¬ë¬¼í•¨ì˜ ì¡°í•©',
            story: 'ê¹€ë™í˜„ì˜ ì‚¬ë¬¼í•¨ì´ ì•„ì§ ë‚¨ì•„ìˆë‹¤. ë¬¸ì— ì—°í•„ë¡œ ì ì–´ë‘” ë©”ëª¨.',
            question: 'ì‚¬ë¬¼í•¨ ì¡°í•©ì„ ê³„ì‚°í•˜ë¼.\n\n<b>ì²« ë²ˆì§¸: ë°˜ ë²ˆí˜¸(2) Ã— 2 = ?\në‘ ë²ˆì§¸: ìƒì¼ ì›”(12) + ì¼(8) = ?\nì„¸ ë²ˆì§¸: ì°½ê°€ë¶€í„° ì¤„ ìˆ˜ = 5</b>\n\nì„¸ ìˆ«ìë¥¼ ì´ì–´ì„œ ì…ë ¥í•˜ì‹œì˜¤.',
            hint: '2Ã—2=4, 12+8=20, 5 â†’ "4205"',
            validate: function(i){return i.replace(/\s/g,'') === '4205'} },
          { type:'general', title:'ğŸ“ í¼ì¦ 2: í•™ìŠµ ê³„íší‘œ',
            story: 'ì‚¬ë¬¼í•¨ ì•ˆ ìª½ì§€.\n"ì˜¤ëŠ˜ ë°¤ ì§€í•˜ì‹¤ì—ì„œ ë§Œë‚˜. ë¹„ë°€ì„ í™•ì¸í•˜ëŸ¬ ê°„ë‹¤. â€” í˜„ìš°"',
            question: 'ì£¼ê°„ ì´ ììŠµ ì‹œê°„ì„ ê³„ì‚°í•˜ë¼.\n\n<b>ì›”: 3ì‹œê°„\ní™”: 5ì‹œê°„\nìˆ˜: 2ì‹œê°„\nëª©: 4ì‹œê°„\nê¸ˆ: 6ì‹œê°„</b>\n\n3 + 5 + 2 + 4 + 6 = ?',
            hint: '3 + 5 + 2 + 4 + 6 = ?',
            validate: function(i){return i.trim() === '20'} },
          { type:'general', title:'ğŸ“ í¼ì¦ 3: ì¹ íŒì˜ ìˆ˜í•™ ë¬¸ì œ',
            story: '"ì§„ì§œ ë¹„ë°€ì€ ì¹ íŒ ë’¤ì— ìˆë‹¤."\nì¹ íŒì— í’€ë‹¤ ë§Œ ìˆ˜í•™ ë¬¸ì œê°€ ë‚¨ì•„ìˆë‹¤.',
            question: 'ì •ìœ¡ê°í˜•ì˜ ë‚´ê°ì˜ í•©ì„ êµ¬í•˜ë¼.\n\n<b>ê³µì‹: (n-2) Ã— 180Â°</b>\n\nì‚¼ê°í˜•(3): 180Â°\nì‚¬ê°í˜•(4): 360Â°\nì˜¤ê°í˜•(5): 540Â°\nìœ¡ê°í˜•(6): ?',
            hint: '(6-2) Ã— 180 = 4 Ã— 180 = ?',
            validate: function(i){return i.trim() === '720'} },
          { type:'general', title:'ğŸ“° í¼ì¦ 4: ë¹„ë°€ ìë£Œì‹¤',
            story: 'ì¹ íŒì´ ì›€ì§ì¸ë‹¤. ë’¤í¸ì— ë¹„ë°€ ìë£Œì‹¤.\nì˜¤ë˜ëœ ì‹ ë¬¸ ìŠ¤í¬ë©: "í™”ì¬", "ì‹¤ì¢…", "ì€í."\nì´ í•™êµì—ëŠ” ì–´ë‘ìš´ ì—­ì‚¬ê°€ ìˆë‹¤.',
            question: 'ì„¸ì¢…ê³ ì˜ ì´ ì‚¬ê±´ ìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>1995ë…„: 1ê±´ (í™”ì¬)\n2003ë…„: 2ê±´ (ì‹¤ì¢…)\n2010ë…„: 1ê±´ (ë¶•ê´´)\n2018ë…„: 3ê±´ (ì‹ì¤‘ë…)\n2023ë…„: 3ê±´ (ì‹¤ì¢…)</b>\n\n1 + 2 + 1 + 3 + 3 = ?',
            hint: '1 + 2 + 1 + 3 + 3 = ?',
            validate: function(i){return i.trim() === '10'} },
          { type:'cpq', cpqIndex:0,
            story: 'ìë£Œì‹¤ ë²½ì— ë¶™ì€ ì§€ë„. í™”ì¬ ì›ì¸ ì¡°ì‚¬ ë³´ê³ ì„œ.\n"í™”ì¬ëŠ” ì‚¬ê³ ê°€ ì•„ë‹ˆì—ˆë‹¤." ê²°ì •ì  ì¥ì†Œê°€ í‘œì‹œë˜ì–´ ìˆë‹¤.',
            storyAfter: 'ë³´ê³ ì„œì˜ ë§ˆì§€ë§‰ í˜ì´ì§€ê°€ í¼ì³ì¡Œë‹¤.' }
        ],
        cliffhanger: 'í™”ì¬ ì¡°ì‚¬ ë³´ê³ ì„œ. ê¸°ë°€ ìŠ¤íƒ¬í”„ê°€ ì°í˜€ìˆë‹¤.\n\n"1994ë…„ 12ì›” 24ì¼. ì„¸ì¢…ê³  ì§€í•˜ ë³´ì¼ëŸ¬ì‹¤ì—ì„œ ë°œí™”."\n"í™”ì¬ëŠ” ì‚¬ê³ ê°€ ì•„ë‹ˆë¼ ì˜ë„ì  ë°©í™”."\n"ëª©ì : ì§€í•˜ì‹¤ì˜ ì¦ê±° ì¸ë©¸."\n\nì¦ê±°ê°€ ë­ì˜€ì„ê¹Œ?\n\në³´ê³ ì„œì— ì²¨ë¶€ëœ ìƒì¡´ì ëª…ë‹¨. ì„¸ ë²ˆì§¸ ì´ë¦„.\nì§ì—…ë€: "ê·¸ë€ë° ì˜¤í˜ë¼ í•˜ìš°ìŠ¤ ë‹¨ì›"\n\nì¡¸ì—…ì•¨ë²”ì—ì„œ ì§€ì›Œì¡Œë˜ ì„¸ ë²ˆì§¸ ì‚¬ëŒ.\nê·¸ê°€ ì˜¤í˜ë¼ ê·¹ì¥ì— ìˆë‹¤.'
      },
      {
        id: 'ch3_opera',
        title: 'Ch.3 â€” ì˜¤í˜ë¼ ê·¹ì¥',
        desc: '100ë…„ ëœ ê·¹ì¥. ë¬´ëŒ€ ì•„ë˜ì— ìˆ¨ê²¨ì§„ ë¹„ë°€.',
        time: '15ë¶„',
        intro: 'ê·¸ë€ë° ì˜¤í˜ë¼ í•˜ìš°ìŠ¤. 100ë…„ ì—­ì‚¬ì˜ ê·¹ì¥.\nê³µì—°ì€ ëë‚¬ì§€ë§Œ ì¡°ëª…ì´ ì¼œì ¸ ìˆë‹¤. ë¬´ëŒ€ ìœ„ì— í•œ ì‚¬ëŒì´ ì„œ ìˆë‹¤.\në‹¹ì‹ ì„ ê¸°ë‹¤ë¦¬ê³  ìˆì—ˆë‹¤ëŠ” ë“¯ì´.\n"ì˜ ì™”ì–´. êµìˆ˜ë„, í˜„ìš°ë„ ì—¬ê¸°ê¹Œì§€ ì™”ì—ˆì§€."\nê·¸ê°€ ë’¤ëŒì•„ì„œëŠ” ìˆœê°„, ë¬´ëŒ€ê°€ êº¼ì§€ê³  ê¸°ê³„ì¥ì¹˜ê°€ ì‘ë™í•œë‹¤.',
        puzzles: [
          { type:'general', title:'ğŸ¼ í¼ì¦ 1: ì•…ë³´ì˜ ì•ŒíŒŒë²³ ì•”í˜¸',
            story: 'ë¶„ì¥ì‹¤. í™”ì¥ëŒ€ ìœ„ ì•…ë³´ì— ë¹¨ê°„ íœìœ¼ë¡œ ìŒí‘œì— ë™ê·¸ë¼ë¯¸ê°€ ì³ì ¸ìˆë‹¤.',
            question: 'ìŒí‘œë¥¼ ì•ŒíŒŒë²³ ìˆœì„œë¡œ ë³€í™˜í•˜ë¼.\n\n<b>A=1, B=2, C=3, D=4, E=5, F=6, G=7</b>\n\ní‘œì‹œëœ ìŒí‘œ:\nC(3), D(4), E(5), C(3), G(7)\n\në‹¤ì„¯ ìˆ«ìë¥¼ ì´ì–´ì„œ ì…ë ¥í•˜ì‹œì˜¤.',
            hint: 'C=3, D=4, E=5, C=3, G=7',
            validate: function(i){return i.replace(/\s/g,'') === '34537'} },
          { type:'general', title:'ğŸ“” í¼ì¦ 2: ìœ„í˜‘ í¸ì§€ì˜ ë¡œë§ˆ ìˆ«ì',
            story: 'ë¶„ì¥ëŒ€ ì„œë. ìœ„í˜‘ í¸ì§€ ë„¤ í†µ.\n"ì§„ì‹¤ì„ ë§í•˜ë©´ ì£½ëŠ”ë‹¤."',
            question: 'ìœ„í˜‘ í¸ì§€ë¥¼ ë°›ì€ ì›”ì˜ í•©ì„ êµ¬í•˜ë¼.\n\n<b>Ië²ˆì§¸: IIIì›” (3ì›”)\nIIë²ˆì§¸: VIIì›” (7ì›”)\nIIIë²ˆì§¸: IXì›” (9ì›”)\nIVë²ˆì§¸: XIIì›” (12ì›”)</b>\n\n3 + 7 + 9 + 12 = ?',
            hint: '3 + 7 + 9 + 12 = ?',
            validate: function(i){return i.trim() === '31'} },
          { type:'general', title:'ğŸ» í¼ì¦ 3: ì˜¤ì¼€ìŠ¤íŠ¸ë¼ ë°°ì¹˜ íŒ¨í„´',
            story: 'ì§€í•˜ ì•…ê¸° ë³´ê´€ì†Œ. ì•…ê¸°ë“¤ì´ ìˆ˜í•™ì  íŒ¨í„´ìœ¼ë¡œ ë°°ì—´ë˜ì–´ ìˆë‹¤.',
            question: 'íŒ¨í„´ì„ ë¶„ì„í•˜ë¼.\n\n<b>1ì—´: 8ëŒ€\n2ì—´: 6ëŒ€ (-2)\n3ì—´: 4ëŒ€ (-2)\n4ì—´: 2ëŒ€ (-2)\n5ì—´: ?</b>\n\n5ì—´ì—ëŠ” ëª‡ ëŒ€?',
            hint: '8â†’6â†’4â†’2â†’?',
            validate: function(i){return i.trim() === '0'} },
          { type:'general', title:'ğŸšª í¼ì¦ 4: ë¬´ëŒ€ ê¸°ê³„ì‹¤',
            story: 'ê¸°ê³„ì‹¤. 100ë…„ ëœ ì¥ì¹˜ë“¤ ì‚¬ì´ì— ë§ˆì§€ë§‰ í¼ì¦.\n"ì´ ê·¹ì¥ì€ ê·¸ë“¤ì˜ ê±°ì ì´ì—ˆë‹¤."',
            question: 'ê·¹ì¥ ê±´ë¦½ ì—°ìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>ê±´ë¦½: 1924ë…„\ní˜„ì¬: 2024ë…„</b>\n\n2024 - 1924 = ?',
            hint: '2024 - 1924 = ?',
            validate: function(i){return i.trim() === '100'} },
          { type:'cpq', cpqIndex:0,
            story: 'ë¬´ëŒ€ ì•„ë˜ ë¹„ë°€ ê¸°ë¡ë³´ê´€ì†Œ.\n"ìœ ë ¹ì˜ ì •ì²´ë¥¼ ì•Œì•„ëƒˆë‹¤. ì¦ê±°ê°€ ì´ ì¥ì†Œì— ìˆë‹¤."',
            storyAfter: 'ê¸°ë¡ë³´ê´€ì†Œì˜ ë§ˆì§€ë§‰ ì„œë¥˜ê°€ ë“œëŸ¬ë‚¬ë‹¤.' }
        ],
        cliffhanger: 'ê¸°ë¡ë³´ê´€ì†Œì—ì„œ ë‚˜ì˜¨ ì„œë¥˜ë­‰ì¹˜.\n\nì„¸ ë²ˆì§¸ ë‚¨ìì˜ ê³ ë°±.\n"ìš°ë¦¬ ì…‹ì€ 1994ë…„ í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì´ë¸Œ, í•™êµ ì§€í•˜ì‹¤ì—ì„œ ê·¸ê²ƒì„ ë´¤ë‹¤."\n"ì¸ì²´ ì‹¤í—˜ ê¸°ë¡. ì•„ì´ë“¤ì„ ëŒ€ìƒìœ¼ë¡œ í•œ."\n"í™”ì¬ëŠ” ì¦ê±°ë¥¼ íƒœìš°ê¸° ìœ„í•œ ê²ƒì´ì—ˆë‹¤."\n\në§ˆì§€ë§‰ í˜ì´ì§€.\n"ìµœí˜„ìš°ëŠ” ì´ê±¸ ì„¸ìƒì— ì•Œë¦¬ë ¤ë‹¤ ì‚¬ë¼ì¡Œë‹¤."\n"ê¹€ë™í˜„ êµìˆ˜ëŠ” ì¦ê±°ë¥¼ ëª¨ìœ¼ë‹¤ ê°ê¸ˆë‹¹í–ˆë‹¤."\n"ë‚˜ëŠ”... ë§ˆì§€ë§‰ íŠ¸ë¦­ì„ ì¤€ë¹„í–ˆë‹¤."\n\nì„œë¥˜ ë’·ë©´ì— ë„ì¥.\n"ì„±ëª¨ì˜ë£Œì¬ë‹¨"\n\níì‡„ëœ ì„±ëª¨ë³‘ì›. 304í˜¸.\nëª¨ë“  ê²ƒì€ ê±°ê¸°ì„œ ì‹œì‘ëë‹¤.'
      }
    ]
  },
  {
    id: 'hospital',
    title: '304í˜¸ì˜ ê¸°ì–µ',
    icon: 'ğŸ¥',
    difficulty: 3,
    desc: '10ë…„ ì „ íì‡„ëœ ë³‘ì›. 304í˜¸ í™˜ìë“¤ì´ ì „ì› ë™ì‹œì— ì‚¬ë¼ì§„ ì‚¬ê±´. ì§„ì‹¤ì„ íŒŒí—¤ì³ë¼.',
    chapters: [
      {
        id: 'ch1_hospital',
        title: 'Ch.1 â€” íë³‘ì› 304í˜¸',
        desc: 'ë°¤ë§ˆë‹¤ ë¶ˆì´ ì¼œì§€ëŠ” íë³‘ì›. 10ë…„ ì „ ê·¸ë‚  ë°¤ì˜ ì§„ì‹¤.',
        time: '14ë¶„',
        intro: 'ì„±ëª¨ë³‘ì›. 10ë…„ ì „ ì˜ë£Œì‚¬ê³ ë¡œ íì‡„ëë‹¤.\ní•˜ì§€ë§Œ "ì˜ë£Œì‚¬ê³ "ëŠ” ê³µì‹ ë°œí‘œì¼ ë¿ì´ë‹¤.\n304í˜¸ì—ì„œ ë°¤ë§ˆë‹¤ ë¶ˆë¹›ì´ ì¼œì§„ë‹¤ëŠ” ì œë³´.\në‹¹ì‹ ì´ ë“¤ì–´ì„  ìˆœê°„, ë³µë„ ëì—ì„œ ë°œìêµ­ ì†Œë¦¬.\n10ë…„ê°„ ì•„ë¬´ë„ ë“¤ì–´ì˜¤ì§€ ì•Šì•˜ì„ ì´ ë³‘ì›ì—ì„œ.',
        puzzles: [
          { type:'general', title:'ğŸ’Š í¼ì¦ 1: í™˜ì ì°¨íŠ¸ì˜ ë³µìš©ëŸ‰',
            story: '304í˜¸ ì¹¨ëŒ€ ì˜†, ë‚¡ì€ í™˜ì ì°¨íŠ¸.\në§ˆì§€ë§‰ ê¸°ë¡: "ë°•ë¯¼ìˆ˜, 45ì„¸." ê°„í˜¸ì‚¬ì˜ ë©”ëª¨: "ë³µìš©ëŸ‰ì´ ì—´ì‡ ë‹¤."',
            question: 'í•˜ë£¨ ì´ ë³µìš©ëŸ‰ì„ ê³„ì‚°í•˜ë¼.\n\n<b>ì•„ì¹¨: 2ì •\nì ì‹¬: 1ì •\nì €ë…: 3ì •</b>\n\n2 + 1 + 3 = ?',
            hint: '2 + 1 + 3 = ?',
            validate: function(i){return i.trim() === '6'} },
          { type:'general', title:'ğŸ“‹ í¼ì¦ 2: ì˜ì‚¬ì˜ ì§„ë£Œ ê¸°ë¡',
            story: 'ì¹¨ëŒ€ ì•„ë˜ ê¸ˆê³ . ê¹€ì˜í˜¸ ì˜ì‚¬ì˜ ìˆ˜ì²©.\n"í™˜ìë“¤ì´ ê°‘ìê¸° ì•…í™”ë˜ê³  ìˆë‹¤. ì•½ì´ ë°”ë€Œì—ˆë‹¤."',
            question: 'ì£¼ê°„ ì´ ì§„ë£Œ í™˜ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>ì›”: 12ëª…\ní™”: 8ëª…\nìˆ˜: 15ëª…\nëª©: 6ëª…\nê¸ˆ: 9ëª…</b>\n\n12 + 8 + 15 + 6 + 9 = ?',
            hint: '12 + 8 + 15 + 6 + 9 = ?',
            validate: function(i){return i.trim() === '50'} },
          { type:'general', title:'ğŸ”¬ í¼ì¦ 3: ì°½ê°€ì˜ í™”í•™ ê³µì‹',
            story: '"ì§„ì‹¤ì„ ë°œê²¬í–ˆë‹¤. ê·¸ë“¤ì´ ì«“ê³  ìˆë‹¤."\nì°½ê°€ ì‹¤í—˜ëŒ€ì— ê¹€ ì˜ì‚¬ê°€ ë‚¨ê¸´ í™”í•™ ê³µì‹.',
            question: 'ë“±ì¥í•˜ëŠ” ì›ì†Œì˜ ì²« ê¸€ìë¥¼ ë‚˜ì—´í•˜ë¼.\n\n<b>Hâ‚‚O + NaCl\n2Hâ‚‚ + Oâ‚‚ = 2Hâ‚‚O\nCâ‚†Hâ‚â‚‚Oâ‚† + 6Oâ‚‚ = 6COâ‚‚ + 6Hâ‚‚O</b>\n\nì›ì†Œ: H(ìˆ˜ì†Œ), O(ì‚°ì†Œ), Na(ë‚˜íŠ¸ë¥¨), Cl(ì—¼ì†Œ), C(íƒ„ì†Œ)\nì²« ê¸€ì ìˆœì„œ: H, O, N, C, C',
            hint: 'H, O, N, C, C â†’ HONCC',
            validate: function(i){return i.toUpperCase().replace(/\s/g,'') === 'HONCC'} },
          { type:'general', title:'ğŸ—‚ï¸ í¼ì¦ 4: ë³‘ì› ì´ ì¸ì›',
            story: 'ë¹„ë°€ ì„œë. ê¹€ ì˜ì‚¬ì˜ ìµœì¢… ë³´ê³ ì„œ.\n"íì‡„ì˜ ì§„ì§œ ì›ì¸ì„ ì°¾ì•˜ë‹¤. ì˜ë£Œì‚¬ê³ ê°€ ì•„ë‹ˆë‹¤."',
            question: 'ë³‘ì› ì „ì²´ ì¸ì›ì„ ê³„ì‚°í•˜ë¼.\n\n<b>ì…ì› í™˜ì: 45ëª…\nì™¸ë˜ í™˜ì: 128ëª…\nì˜ë£Œì§„: 23ëª…\nê´€ë¦¬ì§: 14ëª…</b>\n\n45 + 128 + 23 + 14 = ?',
            hint: '45 + 128 + 23 + 14 = ?',
            validate: function(i){return i.trim() === '210'} },
          { type:'cpq', cpqIndex:0,
            story: '"304í˜¸ì˜ ì§„ì§œ ë¹„ë°€. ë” í° ìŒëª¨ê°€ ìˆë‹¤."\nê¹€ ì˜ì‚¬ê°€ ëª©ìˆ¨ ê±¸ê³  ì¶”ì í•œ ì¥ì†Œ.',
            storyAfter: 'ë³´ê³ ì„œì˜ ë§ˆì§€ë§‰ ì¥ì´ í•´ë…ëë‹¤.' }
        ],
        cliffhanger: 'ê¹€ì˜í˜¸ ì˜ì‚¬ì˜ ìµœì¢… ë³´ê³ ì„œ.\n\n"304í˜¸ í™˜ì 5ëª…. ì „ì› ê°™ì€ ê³ ì•„ì› ì¶œì‹ ."\n"êµ¬ì„¸ì£¼ ê³ ì•„ì›. 30ë…„ ì „ í™”ì¬ë¡œ íì‡„ëœ ë°”ë¡œ ê·¸ê³³."\n"í™˜ìë“¤ì€ ì–´ë¦° ì‹œì ˆ ì‹¤í—˜ ëŒ€ìƒì´ì—ˆë‹¤."\n"ê·¸ë¦¬ê³  ëˆ„êµ°ê°€ ê·¸ë“¤ì„ ë‹¤ì‹œ ëª¨ì•˜ë‹¤."\n\në³´ê³ ì„œì— ì²¨ë¶€ëœ ì‚¬ì§„.\nê³ ì•„ì› ì •ë¬¸. ìµœê·¼ì— ì°íŒ ê²ƒì´ë‹¤.\nì² ì¡°ë§ì´ ìƒˆê²ƒìœ¼ë¡œ êµì²´ë˜ì–´ ìˆë‹¤.\n\nëˆ„êµ°ê°€ ê·¸ê³³ì„ ë‹¤ì‹œ ì‚¬ìš©í•˜ê³  ìˆë‹¤.'
      },
      {
        id: 'ch2_orphanage',
        title: 'Ch.2 â€” ë²„ë ¤ì§„ ê³ ì•„ì›',
        desc: '30ë…„ ì „ ë¶ˆíƒ„ ê³ ì•„ì›. ë°¤ë§ˆë‹¤ ì•„ì´ë“¤ì˜ ìš¸ìŒì†Œë¦¬ê°€ ë“¤ë¦°ë‹¤.',
        time: '16ë¶„',
        intro: 'êµ¬ì„¸ì£¼ ê³ ì•„ì›. ì™¸ë²½ì€ ê·¸ì„ìŒìœ¼ë¡œ ê¹Œë§£ë‹¤.\nìƒˆ ì² ì¡°ë§. ìƒˆ ìë¬¼ì‡ . ëˆ„êµ°ê°€ ê´€ë¦¬í•˜ê³  ìˆë‹¤.\nì•ˆìœ¼ë¡œ ë“¤ì–´ì„œì ì†Œë…ì•½ ëƒ„ìƒˆ. 30ë…„ ì „ ê±´ë¬¼ì—ì„œ?\n2ì¸µì—ì„œ í¬ë¯¸í•œ ë¶ˆë¹›. ë°œìêµ­ ì†Œë¦¬.\nì´ê³³ì€ ë²„ë ¤ì§€ì§€ ì•Šì•˜ë‹¤.',
        puzzles: [
          { type:'general', title:'ğŸ‘¶ í¼ì¦ 1: ì¬ì›ìƒ ëª…ë‹¨ ë¶„ì„',
            story: 'ì‚¬ë¬´ì‹¤. 30ë…„ ì „ ì¬ì›ìƒ ëª…ë‹¨ì´ ë‚¨ì•„ìˆë‹¤.',
            question: 'ì´ë¦„ ì²« ê¸€ìë¥¼ ê°€ë‚˜ë‹¤ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ë¼.\n\n<b>ì´ë¦„ë“¤:</b> ê¹€ë¯¼ìˆ˜, ë°•ì˜í¬, ì´ì² í˜¸, ì •ìˆ˜ì§„, ìµœì˜ìˆ˜, ì¥ë¯¸ë‚˜, ì˜¤íƒœì‹, ìœ¤ì„œì—°, í™ê¸¸ë™, ê°•í˜œì§„\n\nê°€ë‚˜ë‹¤ ìˆœ: ê°•, ê¹€, ë°•, ì˜¤, ìœ¤, ì´, ì¥, ì •, ìµœ, í™\n\n<b>ë‹¤ì„¯ ë²ˆì§¸ ê¸€ì</b>ëŠ”?',
            hint: 'ê°•ê¹€ë°•ì˜¤ìœ¤ì´ì¥ì •ìµœí™ â†’ ë‹¤ì„¯ ë²ˆì§¸ëŠ”?',
            validate: function(i){return i.trim() === 'ìœ¤'} },
          { type:'general', title:'ğŸ“– í¼ì¦ 2: ì›ì¥ ìˆ˜ë…€ì˜ ì¼ê¸°',
            story: 'ì›ì¥ ìˆ˜ë…€ì˜ ì¼ê¸°.\n"ì•„ì´ë“¤ì´ ë°¤ë§ˆë‹¤ ì§€í•˜ì‹¤ë¡œ ë°ë ¤ê°€ì§„ë‹¤. ë©ˆì¶°ì•¼ í•œë‹¤."',
            question: 'ì™¸ì¶œ ê¸°ë¡ì˜ íŒ¨í„´ì„ ë¶„ì„í•˜ë¼.\n\n<b>2ì›” 1ì¼ - 3ëª…\n2ì›” 5ì¼ - 3ëª…\n2ì›” 9ì¼ - 3ëª…\n2ì›” 13ì¼ - 3ëª…\n2ì›” ?ì¼ - 3ëª…</b>\n\nê°„ê²©: 4ì¼. ë‹¤ìŒ ë‚ ì§œëŠ” 2ì›” ë©°ì¹ ?',
            hint: '1, 5, 9, 13... +4ì”©. 13 + 4 = ?',
            validate: function(i){return i.trim() === '17'} },
          { type:'general', title:'ğŸ§¸ í¼ì¦ 3: ë†€ì´ë°©ì˜ ì´ì§„ë²•',
            story: '2ì¸µ ë†€ì´ë°©. ì¹ íŒì— ìˆ˜ë…€ê°€ ë‚¨ê¸´ ì´ì§„ë²• ì•”í˜¸.\në³„ê³¼ ê²€ì€ ë™ê·¸ë¼ë¯¸.',
            question: 'ì´ì§„ë²•ì„ ì‹­ì§„ë²•ìœ¼ë¡œ ë³€í™˜í•˜ë¼.\n\n<b>ğŸŒŸâš«ğŸŒŸâš«ğŸŒŸâš«âš«ğŸŒŸ</b> = 10101001\n\n1Ã—128 + 0Ã—64 + 1Ã—32 + 0Ã—16 + 1Ã—8 + 0Ã—4 + 0Ã—2 + 1Ã—1 = ?',
            hint: '128 + 32 + 8 + 1 = ?',
            validate: function(i){return i.trim() === '169'} },
          { type:'general', title:'ğŸšª í¼ì¦ 4: ì§€í•˜ì‹¤ì˜ ì—°ìˆ˜ ê³„ì‚°',
            story: 'ì§€í•˜ì‹¤. ì–‘ì´ˆê°€ ìµœê·¼ì— íƒ„ í”ì .\në²½ì— ìƒˆê²¨ì§„ ê¸€: "ì¹¨ë¬µí•˜ëŠ” ìëŠ” ë” í° ì£„ë¥¼ ì§“ëŠ”ë‹¤."',
            question: 'í™”ì¬ë¶€í„° í˜„ì¬ê¹Œì§€ì˜ ì—°ìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>í™”ì¬: 1994ë…„\ní˜„ì¬: 2024ë…„</b>\n\n2024 - 1994 = ?',
            hint: '2024 - 1994 = ?',
            validate: function(i){return i.trim() === '30'} },
          { type:'cpq', cpqIndex:0,
            story: 'ì§€í•˜ì‹¤ ë²½ ë’¤ ìˆ¨ê²¨ì§„ ë°©.\n"ì•„ì´ë“¤ì€ ì—¬ê¸°ì„œ ì‹¤í—˜ë‹¹í–ˆë‹¤." ì¦ê±°ê°€ ìˆ¨ê²¨ì§„ ë§ˆì§€ë§‰ ì¥ì†Œ.',
            storyAfter: 'ë²½ ë’¤ ë°©ì—ì„œ ìƒìê°€ ë‚˜ì™”ë‹¤.' }
        ],
        cliffhanger: 'ìƒì ì•ˆ. ì…ì–‘ ì„œë¥˜ ìˆ˜ì‹­ í†µ.\n\nì „ë¶€ ê°€ì§œë‹¤. ì…ì–‘ëœ ì•„ì´ë“¤ì€ ê°€ì •ì— ê°„ ê²Œ ì•„ë‹ˆì—ˆë‹¤.\nì„œë¥˜ì˜ ì‹¤ì œ ëª©ì ì§€:\n"ì§€í•˜ì²  7í˜¸ì„  â€” êµ°ì‚¬ íì—­ B-7"\n\nì•„ì´ë“¤ì€ ê·¸ê³³ìœ¼ë¡œ ë³´ë‚´ì¡Œë‹¤.\nì„œë¥˜ ë’·ë©´, ìµœê·¼ ë‚ ì§œì˜ ë©”ëª¨:\n"ì‹¤í—˜ì€ ê³„ì†ë˜ê³  ìˆë‹¤. ìƒˆë¡œìš´ í”¼í—˜ìê°€ í•„ìš”í•˜ë‹¤."\n\n304í˜¸ í™˜ìë“¤ì´ ì‚¬ë¼ì§„ ì´ìœ .\nê·¸ë“¤ì€ ë‹¤ì‹œ ëŒì•„ê°„ ê²ƒì´ë‹¤.'
      },
      {
        id: 'ch3_subway',
        title: 'Ch.3 â€” ì§€í•˜ì²  íì—­',
        desc: 'ë´‰ì¸ëœ êµ°ì‚¬ íì—­. ì•„ì´ë“¤ì´ ë³´ë‚´ì§„ ê³³.',
        time: '16ë¶„',
        intro: '7í˜¸ì„  ë§ˆì§€ë§‰ ì—´ì°¨ê°€ ë– ë‚œ ë’¤.\nìœ ì§€ë³´ìˆ˜ í†µë¡œë¥¼ í†µí•´ ë´‰ì¸ëœ B-7 íì—­ìœ¼ë¡œ ì§„ì…í–ˆë‹¤.\ní”Œë«í¼ì€ ê¹¨ë—í•˜ë‹¤. ë„ˆë¬´ ê¹¨ë—í•˜ë‹¤. ê´€ë¦¬ë˜ê³  ìˆë‹¤.\ní˜•ê´‘ë“±ì´ ê¹œë¹¡ì´ê³ , ì–´ë”˜ê°€ì—ì„œ ê¸°ê³„ìŒì´ ë“¤ë¦°ë‹¤.\nì´ê³³ì€ ì—­ì´ ì•„ë‹ˆë‹¤. ìœ„ì¥ëœ ì‹œì„¤ì´ë‹¤.',
        puzzles: [
          { type:'general', title:'ğŸ—ºï¸ í¼ì¦ 1: ë…¸ì„ ë„ì˜ í™˜ìŠ¹ì—­',
            story: 'ë²½ë©´ ë…¸ì„ ë„ì— ë¹¨ê°„ íœìœ¼ë¡œ í‘œì‹œëœ ì—­ë“¤.\nì¼ë°˜ ì§€ë„ì—ëŠ” ì—†ëŠ” ì—­ì´ ì¶”ê°€ë˜ì–´ ìˆë‹¤.',
            question: 'í™˜ìŠ¹ ê°€ëŠ¥í•œ ì—­ì˜ ê°œìˆ˜ë¥¼ ì„¸ì–´ë¼.\n\n<b>í™ëŒ€ì…êµ¬: 2í˜¸ì„  â†” 6í˜¸ì„  (í™˜ìŠ¹)\nì‹ ì´Œ: 2í˜¸ì„ ë§Œ\nì´ëŒ€: 2í˜¸ì„ ë§Œ\nì¶©ì •ë¡œ: 2í˜¸ì„  â†” 5í˜¸ì„  (í™˜ìŠ¹)</b>\n\ní™˜ìŠ¹ì—­ ê°œìˆ˜ëŠ”?',
            hint: 'í™ëŒ€ì…êµ¬, ì¶©ì •ë¡œ = 2ê°œ',
            validate: function(i){return i.trim() === '2'} },
          { type:'general', title:'ğŸ“‹ í¼ì¦ 2: ì‹¤ì¢…ì ê¸°ë¡',
            story: 'ê´€ì œì‹¤. ì´ê³³ì„ ì§€ë‚˜ê°„ ì‚¬ëŒë“¤ì˜ ê¸°ë¡.\në²ˆí˜¸ë§Œ ìˆê³  ì´ë¦„ì€ ì—†ë‹¤. ê·¸ë“¤ì€ ì‚¬ëŒì´ ì•„ë‹ˆë¼ ë²ˆí˜¸ì˜€ë‹¤.',
            question: 'ì‹¤ì¢…ëœ í”¼í—˜ì ìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>Aë™: íƒ‘ìŠ¹ 8ëª…, ì‹¤ì¢… 2ëª…\nBë™: íƒ‘ìŠ¹ 6ëª…, ì‹¤ì¢… 3ëª…\nCë™: íƒ‘ìŠ¹ 10ëª…, ì‹¤ì¢… 5ëª…\nDë™: íƒ‘ìŠ¹ 4ëª…, ì‹¤ì¢… 2ëª…</b>\n\nì´ ì‹¤ì¢…ì: 2 + 3 + 5 + 2 = ?',
            hint: '2 + 3 + 5 + 2 = ?',
            validate: function(i){return i.trim() === '12'} },
          { type:'general', title:'â° í¼ì¦ 3: ìš´í–‰ ì‹œê°„ ê³„ì‚°',
            story: 'ìš´ì „ì„ ì„œëì— ë¹„ë°€ ì‹œê°„í‘œ.\nì´ ì‹œì„¤ê³¼ ì™¸ë¶€ë¥¼ ì—°ê²°í•˜ëŠ” ì…”í‹€ì˜ ì‹œê°„í‘œë‹¤.',
            question: 'ìš´í–‰ ì‹œê°„ì„ ê³„ì‚°í•˜ë¼.\n\n<b>ì¶œë°œ: 23:45\në„ì°©: 01:15 (ë‹¤ìŒë‚ )</b>\n\n23:45 â†’ 00:00 = 15ë¶„\n00:00 â†’ 01:15 = 75ë¶„\n\nì´ ëª‡ ë¶„?',
            hint: '15 + 75 = ?',
            validate: function(i){return i.trim() === '90'} },
          { type:'general', title:'ğŸšª í¼ì¦ 4: ì¦ì–¸ ë¶„ì„',
            story: 'ë…¹ìŒê¸°. íƒˆì¶œí•œ í”¼í—˜ìì˜ ì¦ì–¸ì´ ë…¹ìŒë˜ì–´ ìˆë‹¤.\në–¨ë¦¬ëŠ” ëª©ì†Œë¦¬. "ê·¸ë“¤ì´ ê±°ì§“ë§ì„ í•˜ê³  ìˆì–´ìš”."',
            question: 'ì¦ì–¸ì˜ ì§„ìœ„ë¥¼ ë¶„ì„í•˜ë¼.\n\n<b>A: "Bê°€ ê±°ì§“ë§"\nB: "ìš°ë¦¬ ì¤‘ í•œ ëª…ë§Œ ì§„ì‹¤"\nC: "Aì˜ ë§ì´ ë§ë‹¤"\nD: "Bì˜ ë§ì´ í‹€ë ¸ë‹¤"</b>\n\nBê°€ ê±°ì§“ì´ë©´ â†’ A(ì°¸), C(ì°¸), D(ì°¸)\n\nì§„ì‹¤ì„ ë§í•˜ëŠ” ì‚¬ëŒì€ ì´ ëª‡ ëª…?',
            hint: 'A, C, Dê°€ ì§„ì‹¤ = 3ëª…',
            validate: function(i){return i.trim() === '3'} },
          { type:'cpq', cpqIndex:0,
            story: 'ì‹œì„¤ ìµœì‹¬ë¶€. ì‹¤í—˜ì‹¤ ë¬¸ ì•.\në§ˆì§€ë§‰ ì¸ì¦ì´ í•„ìš”í•˜ë‹¤. ê²°ì •ì  ì¥ì†Œì˜ ê±°ë¦¬ë¥¼ í™•ì¸í•˜ë¼.',
            storyAfter: 'ì‹¤í—˜ì‹¤ ë¬¸ì´ ì—´ë ¸ë‹¤.' }
        ],
        cliffhanger: 'ì‹¤í—˜ì‹¤.\n\në²½ë©´ ê°€ë“ ì‚¬ì§„ê³¼ ì„œë¥˜. 30ë…„ê°„ì˜ ê¸°ë¡.\nì•„ì´ë“¤ì˜ ì„±ì¥ ì‚¬ì§„. ê°™ì€ ì•„ì´ë“¤ì´ ì–´ë¥¸ì´ ë˜ì–´ê°€ëŠ” ê³¼ì •.\n304í˜¸ í™˜ìë“¤ì´ë‹¤.\n\nê·¸ë¦¬ê³  ì„œë¥˜ ë§¨ ìœ„, ì¬ë‹¨ ë¡œê³ .\n"êµ­ë¦½ ê³ ê³ í•™ ë°•ë¬¼ê´€ ì‚°í•˜ íŠ¹ìˆ˜ì—°êµ¬ì¬ë‹¨"\n\në°•ë¬¼ê´€.\nê¹€ë™í˜„ êµìˆ˜ê°€ ì†Œì†ëœ ë°”ë¡œ ê·¸ ë°•ë¬¼ê´€.\n\nêµìˆ˜ëŠ” ì´ ì‚¬ì‹¤ì„ ì•Œê³  ìˆì—ˆë‹¤.\nì•„ë‹ˆ, êµìˆ˜ëŠ” ì´ ì¬ë‹¨ì˜ ì¼ì›ì´ì—ˆë‹¤.\n\në²½ì— ë¶™ì€ ì¡°ì§ë„. ìµœìƒìœ„ì— ì íŒ ì´ë¦„.\n"ì¬ë‹¨ ì´ì‚¬ì¥: â–¡â–¡â–¡"\nì´ë¦„ì´ ê²€ê²Œ ì¹ í•´ì ¸ ìˆë‹¤.\n\ní•˜ì§€ë§Œ ì•„ë˜ ë©”ëª¨ê°€ ìˆë‹¤.\n"ì§€í•˜ ì „ì‹œì‹¤ Bê´€. ëª¨ë“  ë‹µì´ ê±°ê¸° ìˆë‹¤."'
      },
      {
        id: 'ch4_museum',
        title: 'Ch.4 â€” ë°•ë¬¼ê´€ì˜ ì§€í•˜',
        desc: 'êµ­ë¦½ ë°•ë¬¼ê´€ ì „ì‹œê´€ ì•„ë˜ ìˆ¨ê²¨ì§„ ì—°êµ¬ì†Œ. 10ë…„ ì „ ì‚¬ê±´ì˜ ì „ëª¨.',
        time: '15ë¶„',
        intro: 'êµ­ë¦½ ê³ ê³ í•™ ë°•ë¬¼ê´€. íê´€ í›„ ì•¼ê°„.\nì§€í•˜ Bê´€ ì…êµ¬. ì¼ë°˜ì¸ ì¶œì… ê¸ˆì§€ êµ¬ì—­.\nì¹´ë“œí‚¤ê°€ ì‘ë™í•œë‹¤. êµìˆ˜ì˜ ê²ƒì´ë‹ˆê¹Œ.\nì—˜ë¦¬ë² ì´í„°ê°€ ì§€í•˜ 3ì¸µê¹Œì§€ ë‚´ë ¤ê°„ë‹¤.\në¬¸ì´ ì—´ë¦¬ì ì„œëŠ˜í•œ ê³µê¸°ì™€ í•¨ê»˜ ê¸°ê³„ìŒ.\nì—¬ê¸°ëŠ” ë°•ë¬¼ê´€ì´ ì•„ë‹ˆë‹¤.',
        puzzles: [
          { type:'general', title:'ğŸº í¼ì¦ 1: ìœ ë¬¼ ì—°ë„ ì•”í˜¸',
            story: 'ì „ì‹œ êµ¬ì—­ì„ ìœ„ì¥í•œ í†µë¡œ. ìœ ë¬¼ 4ì  ì•ì— ê¹€ êµìˆ˜ê°€ ë‚¨ê¸´ ë©”ëª¨.',
            question: 'ìœ ë¬¼ ì—°ë„ì˜ ë§ˆì§€ë§‰ ìë¦¬ë¥¼ ë‚˜ì—´í•˜ë¼.\n\n<b>íˆ¬íƒ•ì¹´ë©˜ ë§ˆìŠ¤í¬: BC 1323 â†’ 3\nì¹´ë…¸í‘¸ìŠ¤ í•­ì•„ë¦¬: BC 1550 â†’ 0\në¡œì œíƒ€ ìŠ¤í†¤: BC 196 â†’ 6\ní´ë ˆì˜¤íŒŒíŠ¸ë¼ ëª©ê±¸ì´: BC 69 â†’ 9</b>\n\në„¤ ìˆ«ìë¥¼ ì´ì–´ì„œ ì…ë ¥.',
            hint: '3, 0, 6, 9 â†’ 3069',
            validate: function(i){return i.replace(/\s/g,'') === '3069'} },
          { type:'general', title:'ğŸ““ í¼ì¦ 2: ìˆœì°° ê¸°ë¡ íŒ¨í„´',
            story: 'ê²½ë¹„ì› ìˆœì°° ì¼ì§€.\n"ìœ ë¬¼ì´ ì œìë¦¬ì— ì—†ë‹¤. ë°¤ë§ˆë‹¤ ëˆ„êµ°ê°€ ë“¤ì–´ì˜¨ë‹¤."',
            question: 'ì´ë™ ê°ì§€ íŒ¨í„´ì„ ë¶„ì„í•˜ë¼.\n\n<b>ì´ì§‘íŠ¸ê´€: 3ê±´\nê·¸ë¦¬ìŠ¤ê´€: 5ê±´\në¡œë§ˆê´€: 7ê±´\në™ì–‘ê´€: 9ê±´\nì¤‘ì„¸ê´€: ?ê±´</b>\n\n+2ì”© ì¦ê°€. ì¤‘ì„¸ê´€ì€?',
            hint: '3, 5, 7, 9, ? â†’ 11',
            validate: function(i){return i.trim() === '11'} },
          { type:'general', title:'ğŸ›ï¸ í¼ì¦ 3: ìŒì•… ì•”í˜¸',
            story: 'ê·¸ë¦¬ìŠ¤ê´€. ì•„í´ë¡œ ì¡°ê°ìƒ ëŒ€ì¢Œì— ìŒí‘œê°€ ìƒˆê²¨ì ¸ ìˆë‹¤.',
            question: 'ìŒê³„ë¥¼ ìˆ«ìë¡œ ë³€í™˜í•˜ë¼.\n\n<b>ë„(1), ë ˆ(2), ë¯¸(3), íŒŒ(4), ì†”(5), ë¼(6), ì‹œ(7)</b>\n\nì•…ë³´: ì†” ë„ ë ˆ ë¯¸\n= 5 1 2 3\n\në„¤ ìˆ«ìë¥¼ ì´ì–´ì„œ ì…ë ¥.',
            hint: 'ì†”=5, ë„=1, ë ˆ=2, ë¯¸=3',
            validate: function(i){return i.replace(/\s/g,'') === '5123'} },
          { type:'general', title:'ğŸšª í¼ì¦ 4: í™©ì œì˜ ì¬ìœ„ ê¸°ê°„',
            story: 'ë¡œë§ˆê´€ í•´ì‹œê³„ ì˜†. ì¬ë‹¨ ì´ì‚¬ì¥ì˜ ìµœì¢… ê¸°ë¡ì´ ìˆ¨ê²¨ì ¸ ìˆë‹¤.',
            question: 'ê°€ì¥ ì˜¤ë˜ í†µì¹˜í•œ í™©ì œì˜ ì¬ìœ„ ê¸°ê°„ì€?\n\n<b>ì•„ìš°êµ¬ìŠ¤íˆ¬ìŠ¤: 45ë…„\níŠ¸ë¼ì•¼ëˆ„ìŠ¤: 19ë…„\ní•˜ë“œë¦¬ì•„ëˆ„ìŠ¤: 21ë…„\në§ˆë¥´ì¿ ìŠ¤: 19ë…„</b>\n\nìµœëŒ€ê°’ì€?',
            hint: '45, 19, 21, 19 ì¤‘ ìµœëŒ€',
            validate: function(i){return i.trim() === '45'} },
          { type:'cpq', cpqIndex:0,
            story: 'ìµœì‹¬ë¶€ ë¹„ë°€ ìˆ˜ì¥ê³ .\n"ëª¨ë“  ì¦ê±°ê°€ ì—¬ê¸° ìˆë‹¤." ë§ˆì§€ë§‰ ì¥ì†Œì˜ ê±°ë¦¬ë¥¼ í™•ì¸í•˜ë¼.',
            storyAfter: 'ìˆ˜ì¥ê³ ì˜ ìµœì¢… ë¬¸ì„œê°€ ë“œëŸ¬ë‚¬ë‹¤.' }
        ],
        cliffhanger: 'ìˆ˜ì¥ê³  ì¤‘ì•™. ëŒ€í˜• ìŠ¤í¬ë¦°.\n\nì¬ìƒ ë²„íŠ¼ì„ ëˆ„ë¥´ì ì˜ìƒì´ í˜ëŸ¬ë‚˜ì˜¨ë‹¤.\nì¬ë‹¨ ì´ì‚¬ì¥ì˜ ì–¼êµ´.\n\n"304í˜¸ í™˜ìë“¤ì€ ì‚¬ë¼ì§„ ê²Œ ì•„ë‹™ë‹ˆë‹¤."\n"ê·¸ë“¤ì€ ì„±ê³µí•œ ê²ë‹ˆë‹¤."\n"30ë…„ê°„ì˜ ì‹¤í—˜ì´ ë“œë””ì–´ ê²°ì‹¤ì„ ë§ºì—ˆìŠµë‹ˆë‹¤."\n"ì´ì œ 2ë‹¨ê³„ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤."\n\nì˜ìƒì´ ëŠê¸´ë‹¤.\n\nìŠ¤í¬ë¦° ì•„ë˜ ì„œë¥˜. 2ë‹¨ê³„ ê³„íšì„œ.\nëª©í‘œ: "ì‹¬í•´ ì—°êµ¬ì†Œ ê°€ë™"\nìœ„ì¹˜: "ë¶íƒœí‰ì–‘ í•´ì € 1000m"\n\nêµìˆ˜ëŠ” ì´ê±¸ ë§‰ìœ¼ë ¤ë‹¤ ê°ê¸ˆë‹¹í•œ ê²ƒì´ë‹¤.\nìµœí˜„ìš°ëŠ” ì´ê±¸ ì•Œë¦¬ë ¤ë‹¤ ì‚¬ë¼ì§„ ê²ƒì´ë‹¤.\n\nì„œë¥˜ ë§ˆì§€ë§‰ ì¤„.\n"ì¹´ìš´íŠ¸ë‹¤ìš´ ì‹œì‘. ì‹œê³„íƒ‘ì—ì„œ ì‹ í˜¸ë¥¼ ë³´ë‚´ë¼."\n\në„ì‹œ ì¤‘ì‹¬ì˜ ì‹œê³„íƒ‘.\n3ì‹œ 33ë¶„ì— ë©ˆì¶˜ ì‹œê³„.\n\nì¹´ìš´íŠ¸ë‹¤ìš´ì€ ì´ë¯¸ ì‹œì‘ëë‹¤.'
      }
    ]
  },
  {
    id: 'deep',
    title: 'ì‹¬í•´ì˜ ë¹„ë°€',
    icon: 'ğŸ”±',
    difficulty: 3,
    desc: 'ëª¨ë“  ì‚¬ê±´ì˜ ë°°í›„. ì‹œê³„íƒ‘ì—ì„œ ì‹œì‘ëœ ì¹´ìš´íŠ¸ë‹¤ìš´. ëë‚´ì§€ ì•Šìœ¼ë©´ ëë‚˜ì§€ ì•ŠëŠ”ë‹¤.',
    chapters: [
      {
        id: 'ch1_clock',
        title: 'Ch.1 â€” ì‹œê³„íƒ‘',
        desc: 'ë„ì‹œ ì¤‘ì‹¬ì˜ ì‹œê³„íƒ‘. ê°‘ìê¸° ë©ˆì¶˜ ì‹œê³„ì™€ í•¨ê»˜ ì‹œì‘ë˜ëŠ” ì¹´ìš´íŠ¸ë‹¤ìš´.',
        time: '14ë¶„',
        intro: 'ê³ ë”• ì‹œê³„íƒ‘. 50ë…„ê°„ í•œ ë²ˆë„ ë©ˆì¶”ì§€ ì•Šì•˜ë‹¤.\nì§€ê¸ˆì€ 3ì‹œ 33ë¶„ì— ë©ˆì¶° ìˆë‹¤.\nì¢…ì§€ê¸° ë°•ì‹œê³„ê°€ ì‚¬ë¼ì¡Œë‹¤.\níƒ‘ ê¼­ëŒ€ê¸°ì— ì˜¬ë¼ì„œì ê³„ë‹¨ì´ ë¬´ë„ˆì¡Œë‹¤.\nê¸°ì–´ ëŒì•„ê°€ëŠ” ì†Œë¦¬ ì‚¬ì´ë¡œ ë¹¨ê°„ LED ìˆ«ìê°€ ê¹œë¹¡ì¸ë‹¤.\nì¹´ìš´íŠ¸ë‹¤ìš´. 72:00:00.',
        puzzles: [
          { type:'general', title:'â° í¼ì¦ 1: ì‹œê³„ë°”ëŠ˜ ê°ë„',
            story: 'ê±°ëŒ€í•œ ì‹œê³„ ê¸°ê³„ì¥ì¹˜. 3ì‹œ 33ë¶„ì— ë©ˆì¶°ìˆë‹¤.\në©”ëª¨: "ê°ë„ê°€ ì—´ì‡ ë‹¤."',
            question: '3ì‹œ 33ë¶„, ì‹œì¹¨ê³¼ ë¶„ì¹¨ ì‚¬ì´ì˜ ê°ë„ë¥¼ êµ¬í•˜ë¼.\n\n<b>ë¶„ì¹¨: 33 Ã— 6Â° = 198Â°\nì‹œì¹¨: 3 Ã— 30Â° + 33 Ã— 0.5Â° = 106.5Â°</b>\n\n|198 - 106.5| = ?\n(ì†Œìˆ˜ì  ì²«ì§¸ ìë¦¬ê¹Œì§€)',
            hint: '198 - 106.5 = 91.5',
            validate: function(i){return i.trim() === '91.5' || i.trim() === '91'} },
          { type:'general', title:'ğŸ“’ í¼ì¦ 2: ì‹œê³„ ì˜¤ì°¨ íŒ¨í„´',
            story: 'ì‘ì—… ì¼ì§€.\n"ì‹œê³„ê°€ ìê¾¸ ëŠë ¤ì§„ë‹¤. ëˆ„êµ°ê°€ ì¡°ì‘í•˜ê³  ìˆë‹¤."',
            question: 'ì˜¤ì°¨ íŒ¨í„´ì„ ë¶„ì„í•˜ë¼.\n\n<b>ì›”: 2ë¶„ ëŠë¦¼\ní™”: 4ë¶„ ëŠë¦¼\nìˆ˜: 8ë¶„ ëŠë¦¼\nëª©: 16ë¶„ ëŠë¦¼\nê¸ˆ: ?ë¶„ ëŠë¦¼</b>\n\në§¤ì¼ 2ë°°ì”©. ê¸ˆìš”ì¼ì€?',
            hint: '16 Ã— 2 = ?',
            validate: function(i){return i.trim() === '32'} },
          { type:'general', title:'ğŸ”” í¼ì¦ 3: ì¢…ì˜ ì§„ë™ ì£¼íŒŒìˆ˜',
            story: 'ì¢…ë£¨. 50ë…„ê°„ ìš¸ë ¤ì˜¨ ì²­ë™ ì¢…ì´ ì¹¨ë¬µí•˜ê³  ìˆë‹¤.\nì¢… ë‚´ë¶€ì— ì¢Œí‘œê°€ ìƒˆê²¨ì ¸ ìˆë‹¤.',
            question: 'ì£¼íŒŒìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>f = ë¬´ê²Œ Ã· ì§ê²½Â²\në¬´ê²Œ: 1,500kg\nì§ê²½: 2m</b>\n\n1500 Ã· 4 = ?',
            hint: '1500 Ã· 4 = ?',
            validate: function(i){return i.trim() === '375'} },
          { type:'general', title:'ğŸšª í¼ì¦ 4: ì‹œê³„íƒ‘ ì—°ìˆ˜',
            story: 'ê¸°ê³„ ë‚´ë¶€. ê±´ì„¤ìê°€ ë‚¨ê¸´ ìµœì¢… ì‹œí—˜.\n"ì´ íƒ‘ì˜ ë‚˜ì´ë¥¼ ë§ì¶°ë¼."',
            question: 'ì‹œê³„íƒ‘ì˜ ì—°ìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>ê±´ì„¤: 1974ë…„\ní˜„ì¬: 2024ë…„</b>\n\n2024 - 1974 = ?',
            hint: '2024 - 1974 = ?',
            validate: function(i){return i.trim() === '50'} },
          { type:'cpq', cpqIndex:0,
            story: 'ì‹œê³„ ë‚´ë¶€ ìˆ¨ê²¨ì§„ ë°©. ì¢Œí‘œê°€ ìƒˆê²¨ì§„ ê¸ˆì†íŒ.\n"ì´ ì¢Œí‘œê°€ ê°€ë¦¬í‚¤ëŠ” ê³³." ë§ˆì§€ë§‰ ì¥ì†Œì˜ ê±°ë¦¬ë¥¼ í™•ì¸í•˜ë¼.',
            storyAfter: 'ê¸ˆì†íŒ ë’·ë©´ì˜ ë©”ì‹œì§€ê°€ í•´ë…ëë‹¤.' }
        ],
        cliffhanger: 'ê¸ˆì†íŒ ë’·ë©´.\ní•´ì € ì¢Œí‘œ: N 35Â°12\'48" E 129Â°45\'36"\n\nê·¸ë¦¬ê³  í•œ ì¤„ì˜ ë©”ì‹œì§€.\n"ëª¨ë“  ë‹µì€ ë°”ë‹¤ ì•„ë˜ì— ìˆë‹¤."\n\nì¹´ìš´íŠ¸ë‹¤ìš´ì´ ë©ˆì·„ë‹¤.\nì‹œê³„ê°€ ë‹¤ì‹œ ì›€ì§ì´ê¸° ì‹œì‘í•œë‹¤.\n\ní•˜ì§€ë§Œ ë°©í–¥ì´ ë°˜ëŒ€ë‹¤.\nì‹œê³„ê°€ ê±°ê¾¸ë¡œ ê°€ê³  ìˆë‹¤.\n\nì¢…ì§€ê¸°ì˜ ë§ˆì§€ë§‰ ë©”ëª¨.\n"ì´ ì‚¬ê±´ì„ 20ë…„ê°„ ì¶”ì í•´ì˜¨ ì‚¬ëŒì´ ìˆë‹¤."\n"íƒì • ì¥í˜œë¦°. ê·¸ë…€ì˜ ì‚¬ë¬´ì†Œì— ëª¨ë“  ì—°ê²°ê³ ë¦¬ê°€ ìˆë‹¤."'
      },
      {
        id: 'ch2_detective',
        title: 'Ch.2 â€” íƒì • ì‚¬ë¬´ì†Œ',
        desc: '20ë…„ê°„ ì´ ì‚¬ê±´ì„ ì¶”ì í•´ì˜¨ íƒì •. ëª¨ë“  ì—°ê²°ê³ ë¦¬ë¥¼ ì •ë¦¬í•œë‹¤.',
        time: '13ë¶„',
        intro: 'ì‚¬ë¦½íƒì • ì¥í˜œë¦°. 20ë…„ ê²½ë ¥.\n"ê²°ì •ì  ë‹¨ì„œë¥¼ ì°¾ì•˜ë‹¤"ëŠ” ì „í™”ë¥¼ ë§ˆì§€ë§‰ìœ¼ë¡œ 3ì¼ì§¸ ì—°ë½ ë‘ì ˆ.\nì‚¬ë¬´ì†Œì— ë“¤ì–´ì„œì ìŒì„±ì´ í˜ëŸ¬ë‚˜ì˜¨ë‹¤.\n"ì—¬ê¸°ê¹Œì§€ ì™”ë‹¤ë©´, ë‹¹ì‹ ë„ ì§„ì‹¤ì— ê°€ê¹Œì›Œì§„ ê±°ì•¼."\n"ë‚´ê°€ ì •ë¦¬í•œ ê±¸ ë´. ëª¨ë“  ê±´ ì—°ê²°ë˜ì–´ ìˆì–´."',
        puzzles: [
          { type:'general', title:'ğŸ” í¼ì¦ 1: ì•Œë¦¬ë°”ì´ ë¶„ì„',
            story: 'ì‚¬ê±´ ìˆ˜ì²©. ëª¨ë“  ì‹œë¦¬ì¦ˆì˜ í•µì‹¬ ì¸ë¬¼ ì•Œë¦¬ë°”ì´.',
            question: '9ì‹œ~9ì‹œ30ë¶„ ì‚¬ì´ì— ììœ ì‹œê°„ì´ ìˆì—ˆë˜ ì‚¬ëŒì€?\n\n<b>ê¹€ëŒ€í‘œ: ì§‘ì— ìˆìŒ\në°•ì°¨ì¥: ì˜í™” ê´€ëŒ ì¤‘\nìµœë¶€ì¥: í¸ì˜ì ì—ì„œ ì´ë™ ì¤‘\nì´ë¹„ì„œ: ì‚¬ìš°ë‚˜ì— ìˆìŒ</b>\n\ní•´ë‹¹ ì„±ì”¨ë¥¼ ì…ë ¥í•˜ì‹œì˜¤.',
            hint: 'ìµœë¶€ì¥ë§Œ ì´ë™ ì¤‘ì— ììœ ì‹œê°„ì´ ìˆë‹¤',
            validate: function(i){return i.trim() === 'ìµœ'} },
          { type:'general', title:'ğŸ•µï¸ í¼ì¦ 2: ì´ë™ ì‹œê°„ ê³„ì‚°',
            story: 'ì¥í˜œë¦°ì˜ ì¶”ì  ê¸°ë¡. í•µì‹¬ ì¸ë¬¼ì˜ ì‹¤ì œ ë™ì„ .',
            question: 'ì´ ì´ë™ ì‹œê°„ì„ ê³„ì‚°í•˜ë¼.\n\n<b>íšŒì‚¬â†’ì¹´í˜ A: 15ë¶„\nì¹´í˜ Aâ†’ì€í–‰: 25ë¶„\nì€í–‰â†’ì§‘: 20ë¶„</b>\n\n15 + 25 + 20 = ?',
            hint: '15 + 25 + 20 = ?',
            validate: function(i){return i.trim() === '60'} },
          { type:'general', title:'ğŸ’° í¼ì¦ 3: ì¬ë‹¨ ìê¸ˆ ì¶”ì ',
            story: '"íŠ¹ìˆ˜ì—°êµ¬ì¬ë‹¨ì˜ ìê¸ˆ íë¦„ì„ ì¶”ì í–ˆë‹¤."\nì¥í˜œë¦°ì˜ í•µì‹¬ ë°œê²¬.',
            question: 'ì¬ì‚° ë¶„ë°°ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>ì•„ë“¤: 1/2 = 3/6\në”¸: 1/3 = 2/6\nì†ì: 1/6 = 1/6\nìì„ ë‹¨ì²´: ë‚˜ë¨¸ì§€</b>\n\n3/6 + 2/6 + 1/6 = 6/6 = ì „ë¶€\nìì„ ë‹¨ì²´ ëª«ì€? (ìˆ«ìë¡œ)',
            hint: '6/6 = 1. ë‚¨ëŠ” ê±´ 0',
            validate: function(i){return i.trim() === '0' || i.trim() === '0/6'} },
          { type:'general', title:'ğŸ“‹ í¼ì¦ 4: ì ‘ì´‰ íšŸìˆ˜ í•©ì‚°',
            story: 'ì¥í˜œë¦°ì˜ ìˆ˜ì‚¬ ë…¸íŠ¸ ìµœì¢…ë³¸.\n"ëª¨ë“  ê±´ í•´ì € ì—°êµ¬ì†Œì—ì„œ ì‹œì‘ëë‹¤."',
            question: 'ì´ ì ‘ì´‰ íšŸìˆ˜ë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>ê¹€ëŒ€í‘œ: 7íšŒ\në°•ì°¨ì¥: 12íšŒ\nìµœë¶€ì¥: 5íšŒ\nì´ë¹„ì„œ: 9íšŒ\në³€í˜¸ì‚¬: 6íšŒ</b>\n\n7 + 12 + 5 + 9 + 6 = ?',
            hint: '7 + 12 + 5 + 9 + 6 = ?',
            validate: function(i){return i.trim() === '39'} },
          { type:'cpq', cpqIndex:0,
            story: '"ì§„ë²”ì„ ì°¾ì•˜ë‹¤. ê°ì‹œë‹¹í•˜ê³  ìˆë‹¤."\nì¥í˜œë¦°ì´ ë§ˆì§€ë§‰ìœ¼ë¡œ í–¥í•˜ë ¤ë˜ ì¥ì†Œ.',
            storyAfter: 'ì¥í˜œë¦°ì˜ ë§ˆì§€ë§‰ ë…¹ìŒì´ ì¬ìƒëë‹¤.' }
        ],
        cliffhanger: 'ì¥í˜œë¦°ì˜ ë§ˆì§€ë§‰ ë…¹ìŒ.\n\n"20ë…„ê°„ ì¶”ì í•œ ëì— ëª¨ë“  ê±¸ ì—°ê²°í–ˆì–´."\n"êµìˆ˜ ê¹€ë™í˜„, ë§ˆìˆ ì‚¬ ìµœí˜„ìš°, ì„¸ ë²ˆì§¸ ë‚¨ì."\n"304í˜¸ í™˜ìë“¤, êµ¬ì„¸ì£¼ ê³ ì•„ì›, ì„¸ì¢…ê³  í™”ì¬."\n"ì „ë¶€ í•˜ë‚˜ì˜ í”„ë¡œì íŠ¸ì•¼."\n"ì½”ë“œëª…: QUBE."\n\n"í•´ì € ì—°êµ¬ì†Œ. ë¶íƒœí‰ì–‘ ìˆ˜ì‹¬ 1000m."\n"ê±°ê¸°ì„œ ëª¨ë“  ê²Œ ì‹œì‘ëê³ , ê±°ê¸°ì„œ ëë‚´ì•¼ í•´."\n"ë‚˜ëŠ” ì§€ê¸ˆ ê·¸ê³³ìœ¼ë¡œ ê°„ë‹¤."\n\në…¹ìŒì´ ëŠê¸´ë‹¤.\n\nì±…ìƒ ì„œëì— ì ìˆ˜ì • íƒ‘ìŠ¹ê¶Œ ë‘ ì¥.\ní•œ ì¥ì€ ì¥í˜œë¦° ê²ƒ. í•œ ì¥ì€... ë¹„ì–´ ìˆë‹¤.\n\në‹¹ì‹ ì˜ ì´ë¦„ì„ ì ìœ¼ë¼ëŠ” ëœ»ì´ë‹¤.'
      },
      {
        id: 'ch3_abyss',
        title: 'Ch.3 â€” í•´ì € ì—°êµ¬ì†Œ',
        desc: 'ìˆ˜ì‹¬ 1000m. ëª¨ë“  ë–¡ë°¥ì´ íšŒìˆ˜ë˜ëŠ” ìµœì¢… ìŠ¤í…Œì´ì§€.',
        time: '20ë¶„',
        intro: 'ì ìˆ˜ì •ì´ í•˜ê°•í•œë‹¤. ìˆ˜ì‹¬ 100m... 500m... 1000m.\ní•´ì € ì—°êµ¬ì†Œ "ë”¥ ë¸”ë£¨". ì°½ë°–ìœ¼ë¡œ í‘¸ë¥¸ ë¹›ì´ íë¥¸ë‹¤.\në„í‚¹ ì™„ë£Œ. ì—ì–´ë¡ì´ ì—´ë¦°ë‹¤.\nì¥í˜œë¦°ì´ ìˆë‹¤. ì‚´ì•„ ìˆë‹¤.\n"ë“œë””ì–´ ì™”êµ¬ë‚˜. ì´ì œ ëë‚¼ ë•Œì•¼."\nì‚°ì†Œ ì”ëŸ‰: 3ì‹œê°„. ì‹œê°„ì´ ì—†ë‹¤.',
        puzzles: [
          { type:'general', title:'ğŸ§¬ í¼ì¦ 1: í•´ì € ê¸°ì•• ê³„ì‚°',
            story: 'ì¤‘ì•™ ì œì–´ì‹¤. ê¹€í•´ì–‘ ë°•ì‚¬ì˜ ë§ˆì§€ë§‰ ë¡œê·¸ì¸ í™”ë©´.',
            question: 'ìˆ˜ì‹¬ 1000mì˜ ê¸°ì••ì„ ê³„ì‚°í•˜ë¼.\n\n<b>ìˆ˜ë©´: 1ê¸°ì••\n10më§ˆë‹¤: +1ê¸°ì••</b>\n\n1 + (1000 Ã· 10) = ?',
            hint: '1 + 100 = ?',
            validate: function(i){return i.trim() === '101'} },
          { type:'general', title:'ğŸ“Š í¼ì¦ 2: ìƒëª…ì²´ ì¶œí˜„ íŒ¨í„´',
            story: 'ê¹€í•´ì–‘ ë°•ì‚¬ì˜ ì¼ì§€.\n"ë¯¸ì§€ì˜ ìƒëª…ì²´. ê·¸ë“¤ì´ ìš°ë¦¬ë¥¼ ê´€ì°°í•˜ê³  ìˆë‹¤."',
            question: 'í”¼ë³´ë‚˜ì¹˜ ìˆ˜ì—´ì„ ì ìš©í•˜ë¼.\n\n<b>1ì£¼ì°¨: 1íšŒ\n2ì£¼ì°¨: 1íšŒ\n3ì£¼ì°¨: 2íšŒ\n4ì£¼ì°¨: 3íšŒ\n5ì£¼ì°¨: 5íšŒ\n6ì£¼ì°¨: ?íšŒ</b>\n\nê° í•­ = ì• ë‘ í•­ì˜ í•©. 6ì£¼ì°¨ëŠ”?',
            hint: '3 + 5 = ?',
            validate: function(i){return i.trim() === '8'} },
          { type:'general', title:'ğŸ”¬ í¼ì¦ 3: DNA ì„œì—´ ë³€í™˜',
            story: 'ì‹¤í—˜ì‹¤. í‘¸ë¥¸ ë¹›ì„ ë‚´ëŠ” ë¯¸ì§€ì˜ ìƒ˜í”Œ.\nì´ê²ƒì´ "QUBE í”„ë¡œì íŠ¸"ì˜ í•µì‹¬ì´ì—ˆë‹¤.',
            question: 'DNA ì„œì—´ì„ ìˆ«ìë¡œ ë³€í™˜í•˜ë¼.\n\n<b>A=1, T=2, C=3, G=4</b>\n\nATCG TACG GCTA ATGC\n= 1234 2134 4321 1243\n\n16ìë¦¬ ìˆ«ìë¥¼ ì´ì–´ì„œ ì…ë ¥.',
            hint: 'ATCG=1234, TACG=2134, GCTA=4321, ATGC=1243',
            validate: function(i){return i.replace(/[\s-]/g,'') === '1234213443211243'} },
          { type:'general', title:'ğŸšª í¼ì¦ 4: ë¹„ìƒ íƒˆì¶œ ì½”ë“œ',
            story: 'ì‚°ì†Œê°€ ì¤„ì–´ë“¤ê³  ìˆë‹¤. ë¹„ìƒ íƒˆì¶œ í”„ë¡œí† ì½œì„ ê°€ë™í•´ì•¼ í•œë‹¤.\në§ˆì§€ë§‰ ì¸ì¦ ì½”ë“œ.',
            question: 'ì¸ì¦ ì½”ë“œë¥¼ ê³„ì‚°í•˜ë¼.\n\n<b>ë¯¸ì§€ ìƒëª…ì²´ ìµœì´ˆ ë°œê²¬: 2019ë…„\nì—°êµ¬ì†Œ ê±´ì„¤: 2015ë…„</b>\n\n2019 + 2015 = ?',
            hint: '2019 + 2015 = ?',
            validate: function(i){return i.trim() === '4034'} },
          { type:'cpq', cpqIndex:0,
            story: '"ì´ ìƒëª…ì²´ë“¤ì€ ì§€êµ¬ ìƒëª…ì²´ê°€ ì•„ë‹ˆë‹¤."\nìµœì¢… ì¢Œí‘œ. ë§ˆì§€ë§‰ ì¥ì†Œì˜ ê±°ë¦¬ë¥¼ ì¸¡ì •í•˜ë¼.',
            storyAfter: 'ë¹„ìƒ íƒˆì¶œ ì‹œìŠ¤í…œì´ ê°€ë™ëë‹¤.' }
        ],
        cliffhanger: 'íƒˆì¶œ ì§ì „, ì¥í˜œë¦°ì´ ì¤‘ì•™ ì»´í“¨í„°ì˜ ë§ˆì§€ë§‰ íŒŒì¼ì„ ì—´ì—ˆë‹¤.\n\nQUBE í”„ë¡œì íŠ¸ ìµœì¢… ë³´ê³ ì„œ.\n\n"1994ë…„, ì„¸ì¢…ê³  ì§€í•˜ì‹¤ì—ì„œ ë°œê²¬ëœ ë¯¸ì§€ì˜ ë¬¼ì§ˆ."\n"ì„¸ ëª…ì˜ í•™ìƒì´ ëª©ê²©. ê¹€ë™í˜„, ìµœí˜„ìš°, ê·¸ë¦¬ê³  â–ˆâ–ˆâ–ˆâ–ˆ."\n"ë¬¼ì§ˆì€ í•´ì €ì—ì„œ ì˜¨ ê²ƒì´ì—ˆë‹¤."\n"30ë…„ê°„ì˜ ì—°êµ¬ ê²°ê³¼: ì´ê²ƒì€ ì‹ í˜¸ì˜€ë‹¤."\n"ëˆ„êµ°ê°€ ìš°ë¦¬ì—ê²Œ ë³´ë‚¸ ë©”ì‹œì§€."\n\nì¥í˜œë¦°ì´ ë§í–ˆë‹¤.\n"êµìˆ˜ë„, ë§ˆìˆ ì‚¬ë„, í™˜ìë“¤ë„... ì „ë¶€ ì´ ë¹„ë°€ì„ ì§€í‚¤ê¸° ìœ„í•´ í¬ìƒëœ ê±°ì•¼."\n"í•˜ì§€ë§Œ ì´ì œ ì„¸ìƒì´ ì•Œì•„ì•¼ í•´."\n\në¹„ìƒ íƒˆì¶œ í¬ë“œê°€ ìƒìŠ¹í•œë‹¤.\nìˆ˜ë©´ ìœ„ë¡œ ë– ì˜¤ë¥´ëŠ” ìˆœê°„, ë¼ë””ì˜¤ì—ì„œ ë‰´ìŠ¤ê°€ í˜ëŸ¬ë‚˜ì˜¨ë‹¤.\n\n"ì†ë³´ì…ë‹ˆë‹¤. êµ­ë¦½ ê³ ê³ í•™ ë°•ë¬¼ê´€ íŠ¹ìˆ˜ì—°êµ¬ì¬ë‹¨ì˜ ë¹„ë°€ ì‹¤í—˜ì´ í­ë¡œë˜ì—ˆìŠµë‹ˆë‹¤."\n"ì‹¤ì¢…ëœ êµìˆ˜ ê¹€ë™í˜„ì´ ë¬´ì‚¬íˆ êµ¬ì¶œë˜ì—ˆìœ¼ë©°..."\n\nìµœí˜„ìš°ì˜ ë§ˆì§€ë§‰ íŠ¸ë¦­.\nê·¸ëŠ” ì‚¬ë¼ì§„ ê²Œ ì•„ë‹ˆë¼, ì¦ê±°ë¥¼ ì„¸ìƒì— ë³´ë‚´ê³  ìˆì—ˆë‹¤.\n\në‹¹ì‹ ì€ í•´ëƒˆë‹¤.\n\nğŸ† QUBE â€” ALL CLEAR'
      }
    ]
  }
];

// â”€â”€â”€ ê²Œì„ ìƒíƒœ â”€â”€â”€
var state = { currentSeries:null, currentChapter:null, currentPuzzle:0, cpqCampaigns:[], startTime:null, attempts:0 };

function getProgress() {
  try { return JSON.parse(localStorage.getItem('qube_progress') || '{}'); } catch(e) { return {}; }
}
function saveProgressData(p) { localStorage.setItem('qube_progress', JSON.stringify(p)); }

function isChapterCleared(seriesId, chapterId) {
  var p = getProgress();
  return !!(p[seriesId] && p[seriesId][chapterId]);
}

function isChapterUnlocked(seriesIdx, chapIdx) {
  if (seriesIdx === 0 && chapIdx === 0) return true;
  var s = SERIES[seriesIdx];
  if (chapIdx > 0) {
    return isChapterCleared(s.id, s.chapters[chapIdx - 1].id);
  }
  // First chapter of series: previous series must be fully cleared
  var prevS = SERIES[seriesIdx - 1];
  if (!prevS) return false;
  for (var i = 0; i < prevS.chapters.length; i++) {
    if (!isChapterCleared(prevS.id, prevS.chapters[i].id)) return false;
  }
  return true;
}

function isSeriesUnlocked(seriesIdx) {
  return isChapterUnlocked(seriesIdx, 0);
}

function isSeriesCleared(seriesIdx) {
  var s = SERIES[seriesIdx];
  for (var i = 0; i < s.chapters.length; i++) {
    if (!isChapterCleared(s.id, s.chapters[i].id)) return false;
  }
  return true;
}

function getTotalCleared() {
  var count = 0;
  for (var si = 0; si < SERIES.length; si++) {
    for (var ci = 0; ci < SERIES[si].chapters.length; ci++) {
      if (isChapterCleared(SERIES[si].id, SERIES[si].chapters[ci].id)) count++;
    }
  }
  return count;
}

function getSeriesCleared() {
  var count = 0;
  for (var si = 0; si < SERIES.length; si++) {
    if (isSeriesCleared(si)) count++;
  }
  return count;
}

function getGrade(c) { return c>=10?'ğŸ•µï¸ ì…œë¡':c>=7?'ğŸ” ëª…íƒì •':c>=4?'ğŸ§ íƒì •':c>=2?'ğŸ“‹ ìˆ˜ìŠµíƒì •':'ğŸ”° ì´ˆë³´íƒì •'; }
function formatTime(s) { return Math.floor(s/60)+':'+String(s%60).padStart(2,'0'); }

// â”€â”€â”€ íŒŒí‹°í´ â”€â”€â”€
function createParticles() {
  var c = document.getElementById('particles');
  for(var i=0;i<50;i++){
    var p = document.createElement('div');
    p.className='particle';
    p.style.left=Math.random()*100+'%';
    p.style.animationDuration=(8+Math.random()*12)+'s';
    p.style.animationDelay=Math.random()*10+'s';
    var sz=(2+Math.random()*3)+'px';
    p.style.width=p.style.height=sz;
    p.style.background=Math.random()>.5?'#b44aff':'#00e5ff';
    p.style.boxShadow='0 0 6px '+p.style.background;
    c.appendChild(p);
  }
}

function scrollToSeries() { document.getElementById('series-section').scrollIntoView({behavior:'smooth'}); }

// â”€â”€â”€ í™”ë©´ ì „í™˜ â”€â”€â”€
function showScreen(id) {
  ['home','chapters','game','result'].forEach(function(s){
    document.getElementById(s).classList.toggle('hidden', s!==id);
  });
  document.getElementById('loadingScreen').classList.remove('active');
  if(id!=='home') window.scrollTo(0,0);
}

function goHome() {
  state.currentSeries=null;
  state.currentChapter=null;
  showScreen('home');
  renderHome();
}

function confirmExit() { if(confirm('ì •ë§ ë‚˜ê°€ì‹œê² ìŠµë‹ˆê¹Œ? ì§„í–‰ ìƒí™©ì´ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.')) goHome(); }

// â”€â”€â”€ í™ˆ ë Œë”ë§ â”€â”€â”€
function renderHome() {
  var cleared = getTotalCleared();
  var totalChapters = 0;
  SERIES.forEach(function(s){ totalChapters += s.chapters.length; });

  document.getElementById('statCleared').textContent = cleared;
  document.getElementById('statGrade').textContent = getGrade(cleared).split(' ')[0];
  document.getElementById('statStreak').textContent = getSeriesCleared();
  document.getElementById('seriesProgressText').textContent = 'âœ… ' + cleared + '/' + totalChapters + ' ì±•í„° í´ë¦¬ì–´';

  var html = '';
  for (var si = 0; si < SERIES.length; si++) {
    var s = SERIES[si];
    var unlocked = isSeriesUnlocked(si);
    var serCleared = isSeriesCleared(si);
    var chapCleared = 0;
    for (var ci = 0; ci < s.chapters.length; ci++) {
      if (isChapterCleared(s.id, s.chapters[ci].id)) chapCleared++;
    }
    var stars = '';
    for (var d = 0; d < 3; d++) {
      stars += '<span class="star ' + (d < s.difficulty ? '' : 'empty') + '">' + (d < s.difficulty ? 'â˜…' : 'â˜†') + '</span>';
    }
    var badge = '';
    if (serCleared) badge = '<span class="series-badge badge-clear">âœ… í´ë¦¬ì–´</span>';
    else if (chapCleared > 0) badge = '<span class="series-badge badge-progress">' + chapCleared + '/' + s.chapters.length + '</span>';
    else if (unlocked) badge = '<span class="series-badge badge-new">NEW</span>';

    var lockOverlay = '';
    if (!unlocked) {
      var prevTitle = si > 0 ? SERIES[si-1].title : '';
      lockOverlay = '<div class="series-lock-overlay"><span>ğŸ”’ "' + prevTitle + '" í´ë¦¬ì–´ ì‹œ í•´ê¸ˆ</span></div>';
    }

    html += '<div class="series-card ' + (unlocked ? '' : 'locked') + ' ' + (serCleared ? 'cleared' : '') + '" onclick="' + (unlocked ? 'openSeries('+si+')' : '') + '">';
    html += lockOverlay;
    html += '<div class="series-header">';
    html += '<div class="series-icon">' + s.icon + '</div>';
    html += '<div class="series-info"><div class="series-title">' + s.title + '</div><div class="series-diff">' + stars + '</div></div>';
    html += badge;
    html += '</div>';
    html += '<div class="series-desc">' + s.desc + '</div>';
    html += '<div class="series-footer">';
    html += '<div class="series-chapter-progress">';
    for (var ci2 = 0; ci2 < s.chapters.length; ci2++) {
      if (isChapterCleared(s.id, s.chapters[ci2].id)) html += '<span class="done">âœ…</span> ';
      else if (isChapterUnlocked(si, ci2)) html += 'ğŸ”“ ';
      else html += 'ğŸ”’ ';
    }
    html += '</div></div></div>';
  }
  document.getElementById('seriesGrid').innerHTML = html;
}

// â”€â”€â”€ ì±•í„° ì„ íƒ í™”ë©´ â”€â”€â”€
function openSeries(seriesIdx) {
  var s = SERIES[seriesIdx];
  showScreen('chapters');
  var html = '<div class="chapter-header">';
  html += '<button class="chapter-back" onclick="goHome()">â†</button>';
  html += '<div class="chapter-series-title">' + s.icon + ' ' + s.title + '</div>';
  html += '</div>';
  html += '<div class="chapter-series-desc">' + s.desc + '</div>';
  html += '<div class="chapter-timeline">';

  for (var ci = 0; ci < s.chapters.length; ci++) {
    var ch = s.chapters[ci];
    var cleared = isChapterCleared(s.id, ch.id);
    var unlocked = isChapterUnlocked(seriesIdx, ci);
    var cls = cleared ? 'cleared' : (unlocked ? 'unlocked' : 'locked');
    var dotContent = cleared ? 'âœ“' : (unlocked ? (ci+1) : 'ğŸ”’');

    html += '<div class="chapter-item ' + cls + '">';
    html += '<div class="chapter-dot">' + dotContent + '</div>';
    html += '<div class="chapter-card">';
    html += '<div class="chapter-card-title">' + ch.title + '</div>';
    html += '<div class="chapter-card-desc">' + ch.desc + '</div>';
    html += '<div class="chapter-card-meta">';
    html += '<span>â± ' + ch.time + '</span>';
    if (cleared) {
      html += '<button class="chapter-replay" onclick="startChapter('+seriesIdx+','+ci+')">ë‹¤ì‹œ ë„ì „ ğŸ”„</button>';
    } else if (unlocked) {
      html += '<button class="chapter-enter" onclick="startChapter('+seriesIdx+','+ci+')">ì…ì¥í•˜ê¸° ğŸ”‘</button>';
    } else {
      html += '<span>ğŸ”’ ì´ì „ ì±•í„° í´ë¦¬ì–´ í•„ìš”</span>';
    }
    html += '</div></div></div>';
  }
  html += '</div>';
  document.getElementById('chapters').innerHTML = html;
}

// â”€â”€â”€ ê²Œì„ ì‹œì‘ â”€â”€â”€
async function startChapter(seriesIdx, chapIdx) {
  var s = SERIES[seriesIdx];
  var ch = s.chapters[chapIdx];
  state.currentSeries = s;
  state.currentChapter = ch;
  state.currentSeriesIdx = seriesIdx;
  state.currentChapIdx = chapIdx;
  state.currentPuzzle = 0;
  state.startTime = Date.now();
  state.attempts = 0;

  document.getElementById('loadingScreen').classList.add('active');

  try {
    var cpqCount = ch.puzzles.filter(function(p){return p.type==='cpq';}).length;
    var res = await fetch(API + '/api/random?count=' + cpqCount);
    var data = await res.json();
    state.cpqCampaigns = data.campaigns || [];
  } catch(e) { state.cpqCampaigns = []; }

  showScreen('game');
  document.getElementById('gameTitle').textContent = ch.title;
  renderIntro();
}

function renderIntro() {
  renderProgressBar();
  document.getElementById('gameContent').innerHTML =
    '<div class="story-box"><div class="label">ğŸ“– í”„ë¡¤ë¡œê·¸</div><p>' +
    state.currentChapter.intro.replace(/\n/g,'<br>') +
    '</p></div><button class="btn-next" onclick="renderPuzzle(0)">ì¡°ì‚¬ ì‹œì‘ â†’</button>';
}

function renderProgressBar() {
  var total = state.currentChapter.puzzles.length;
  document.getElementById('gameProgressText').textContent = (state.currentPuzzle+1) + ' / ' + total;
  var dots = '';
  for (var i = 0; i < total; i++) {
    var cls = i < state.currentPuzzle ? 'done' : (i === state.currentPuzzle ? 'active' : '');
    dots += '<div class="prog-dot ' + cls + '"></div>';
  }
  document.getElementById('progressBar').innerHTML = dots;
}

// â”€â”€â”€ í¼ì¦ ë Œë”ë§ â”€â”€â”€
function renderPuzzle(idx) {
  state.currentPuzzle = idx;
  renderProgressBar();
  var puzzle = state.currentChapter.puzzles[idx];
  if (puzzle.type === 'cpq') renderCpqPuzzle(idx, puzzle);
  else renderGeneralPuzzle(idx, puzzle);
}

function renderGeneralPuzzle(idx, puzzle) {
  document.getElementById('gameContent').innerHTML =
    '<div class="story-box"><div class="label">ğŸ“– ìƒí™©</div><p>' + puzzle.story.replace(/\n/g,'<br>') + '</p></div>' +
    '<div class="puzzle-box"><div class="puzzle-label">' + puzzle.title + '</div>' +
    '<div class="puzzle-question">' + puzzle.question.replace(/\n/g,'<br>') + '</div>' +
    '<div class="hint-box hidden" id="hintBox">ğŸ’¡ ' + puzzle.hint + '</div>' +
    '<button class="hint-btn" onclick="document.getElementById(\'hintBox\').classList.remove(\'hidden\');this.remove()">ğŸ’¡ íŒíŠ¸ ë³´ê¸°</button>' +
    '<div class="answer-area"><input type="text" id="answerInput" placeholder="ì •ë‹µì„ ì…ë ¥í•˜ì„¸ìš”" onkeydown="handleEnter(event,'+idx+')">' +
    '<button class="btn-submit" onclick="checkGeneral('+idx+')">í™•ì¸</button></div>' +
    '<div id="feedback"></div></div>';
  setTimeout(function(){ document.getElementById('gameContent').scrollIntoView({behavior:'smooth'}); }, 100);
}

function renderCpqPuzzle(idx, puzzle) {
  var camp = state.cpqCampaigns[puzzle.cpqIndex];
  if(!camp) { nextPuzzle(idx); return; }

  var desc = camp.join_desc || '';
  var keyword = camp.search_keyword || '';
  var placeMatch = desc.match(/\[([^\]]*X[^\]]*)\]/);
  var placeHint = placeMatch ? placeMatch[1] : 'í•´ë‹¹ ì¥ì†Œ';
  var startMatch = desc.match(/ì¶œë°œì§€ë¥¼\s*\[([^\]]+)\]/);
  var startPlace = startMatch ? startMatch[1] : 'ì§€ì •ëœ ì¶œë°œì§€';

  document.getElementById('gameContent').innerHTML =
    '<div class="story-box"><div class="label">ğŸ“– ë‹¨ì„œ ë°œê²¬</div><p>' + puzzle.story.replace(/\n/g,'<br>') + '</p></div>' +
    '<div class="puzzle-box"><div class="puzzle-label">ğŸ” í¼ì¦ ' + (idx+1) + ': ì¥ì†Œ ì¶”ì  ë¯¸ì…˜</div>' +
    '<div class="puzzle-question">ë‹¨ì„œì— ì íŒ ì¥ì†Œë¥¼ ì°¾ì•„ì•¼ í•œë‹¤. ë„¤ì´ë²„ì—ì„œ ê²€ìƒ‰í•˜ì—¬ ê±¸ìŒ ìˆ˜ë¥¼ í™•ì¸í•˜ë¼.</div>' +
    '<div class="cpq-mission"><div class="mission-title">ğŸ“‹ ë¯¸ì…˜ ìˆœì„œ</div>' +
    '<ol class="cpq-steps"><li>ì•„ë˜ í‚¤ì›Œë“œë¥¼ ë³µì‚¬í•˜ì—¬ <b>ë„¤ì´ë²„</b>ì—ì„œ ê²€ìƒ‰</li>' +
    '<li>ê²€ìƒ‰ ê²°ê³¼ì—ì„œ <b>' + placeHint + '</b> í´ë¦­</li>' +
    '<li>í”Œë ˆì´ìŠ¤ì—ì„œ <b>ì§€ë„</b> íƒ­ â†’ <b>ì§€ë„ì•±ìœ¼ë¡œ ë³´ê¸°</b></li>' +
    '<li><b>ë„ì°©</b> ë²„íŠ¼ í´ë¦­</li>' +
    '<li>ì¶œë°œì§€ë¥¼ <b>' + startPlace + '</b>(ìœ¼)ë¡œ ì„¤ì •</li>' +
    '<li><b>ë„ë³´</b> â†’ <b>ê°€ì¥ ë¹ ë¥¸</b> ê²½ë¡œì˜ ê±¸ìŒ ìˆ˜ í™•ì¸</li></ol>' +
    '<div class="cpq-keyword-box"><span class="cpq-keyword" onclick="copyKeyword(this)" title="í´ë¦­í•˜ì—¬ ë³µì‚¬">ğŸ” ' + keyword + '</span></div></div>' +
    '<div class="answer-area" style="margin-top:16px"><input type="number" id="answerInput" placeholder="ê±¸ìŒ ìˆ˜ë¥¼ ì…ë ¥í•˜ì„¸ìš”" onkeydown="handleEnter(event,'+idx+',\'cpq\')">' +
    '<button class="btn-submit" onclick="checkCpq('+idx+')">í™•ì¸</button></div>' +
    '<div id="feedback"></div></div>';
  setTimeout(function(){ document.getElementById('gameContent').scrollIntoView({behavior:'smooth'}); }, 100);
}

// â”€â”€â”€ ì…ë ¥ í•¸ë“¤ëŸ¬ â”€â”€â”€
var isComposing = false;
document.addEventListener('compositionstart', function(){isComposing=true;});
document.addEventListener('compositionend', function(){isComposing=false;});

function handleEnter(e, idx, type) {
  if(e.key==='Enter' && !isComposing) {
    e.preventDefault();
    type==='cpq' ? checkCpq(idx) : checkGeneral(idx);
  }
}

// â”€â”€â”€ ê²€ì¦ â”€â”€â”€
function checkGeneral(idx) {
  var input = document.getElementById('answerInput').value.trim();
  if(!input) return;
  state.attempts++;
  showFeedback(state.currentChapter.puzzles[idx].validate(input), idx);
}

async function checkCpq(idx) {
  var input = document.getElementById('answerInput').value.trim();
  if(!input) return;
  state.attempts++;
  var camp = state.cpqCampaigns[state.currentChapter.puzzles[idx].cpqIndex];
  try {
    var res = await fetch(API + '/api/verify', {method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({campaign_id:camp.id,user_answer:input})});
    var data = await res.json();
    showFeedback(data.correct, idx);
  } catch(e) { showFeedback(false, idx); }
}

function showFeedback(correct, idx) {
  var fb = document.getElementById('feedback');
  var puzzle = state.currentChapter.puzzles[idx];
  var isLast = idx >= state.currentChapter.puzzles.length - 1;
  if(correct) {
    var after = puzzle.storyAfter || '';
    fb.innerHTML = '<div class="feedback correct">âœ… ì •ë‹µ!' + (after ? ' ' + after : '') + '</div>' +
      '<button class="btn-next" onclick="nextPuzzle(' + idx + ')">' + (isLast ? 'ğŸšª ì±•í„° ì™„ë£Œ!' : 'ë‹¤ìŒ í¼ì¦ â†’') + '</button>';
  } else {
    fb.innerHTML = '<div class="feedback wrong">âŒ ì˜¤ë‹µ. ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”.</div>';
    document.getElementById('answerInput').value = '';
    fb.scrollIntoView({behavior:'smooth', block:'center'});
  }
}

function nextPuzzle(cur) {
  if (cur + 1 >= state.currentChapter.puzzles.length) {
    showCliffhanger();
  } else {
    renderPuzzle(cur + 1);
  }
}

// â”€â”€â”€ í´ë¦¬í”„í–‰ì–´ & ê²°ê³¼ â”€â”€â”€
function showCliffhanger() {
  var ch = state.currentChapter;
  var s = state.currentSeries;
  var si = state.currentSeriesIdx;
  var ci = state.currentChapIdx;
  var elapsed = Math.floor((Date.now() - state.startTime) / 1000);

  // Save progress
  var p = getProgress();
  if (!p[s.id]) p[s.id] = {};
  p[s.id][ch.id] = { cleared: true, bestTime: elapsed, lastPlayed: Date.now() };
  saveProgressData(p);

  var isLastChapter = ci >= s.chapters.length - 1;
  var isLastSeries = si >= SERIES.length - 1;
  var isFinalClear = isLastChapter && isLastSeries;

  var gameGrade = 'S';
  if (elapsed > 600) gameGrade = 'C';
  else if (elapsed > 300) gameGrade = 'B';
  else if (elapsed > 180) gameGrade = 'A';

  showScreen('result');
  var html = '';

  if (isFinalClear) {
    spawnConfetti();
    html += '<div class="result-emoji">ğŸ†</div>';
    html += '<div class="result-title">QUBE â€” ALL CLEAR</div>';
    html += '<div class="result-sub">ëª¨ë“  ë¯¸ìŠ¤í„°ë¦¬ë¥¼ í•´ê²°í–ˆìŠµë‹ˆë‹¤</div>';
  } else if (isLastChapter) {
    spawnConfetti();
    html += '<div class="result-emoji">ğŸŠ</div>';
    html += '<div class="result-title">ì‹œë¦¬ì¦ˆ í´ë¦¬ì–´!</div>';
    html += '<div class="result-sub">"' + s.title + '" ì™„ë£Œ!</div>';
  } else {
    html += '<div class="result-emoji">ğŸ‰</div>';
    html += '<div class="result-title">ì±•í„° í´ë¦¬ì–´!</div>';
    html += '<div class="result-sub">' + ch.title + ' ì™„ë£Œ</div>';
  }

  html += '<div class="result-grade">' + gameGrade + ' RANK</div>';
  html += '<div class="result-stats">';
  html += '<div class="result-stat"><div class="result-stat-val">' + formatTime(elapsed) + '</div><div class="result-stat-label">ì†Œìš”ì‹œê°„</div></div>';
  html += '<div class="result-stat"><div class="result-stat-val">' + state.attempts + '</div><div class="result-stat-label">ì‹œë„íšŸìˆ˜</div></div>';
  var totalCleared = getTotalCleared();
  var grade = getGrade(totalCleared);
  html += '<div class="result-stat"><div class="result-stat-val">' + grade.split(' ')[0] + '</div><div class="result-stat-label">' + (grade.split(' ')[1]||'') + '</div></div>';
  html += '</div>';

  // Cliffhanger
  if (ch.cliffhanger) {
    html += '<div class="cliffhanger-box"><div class="label">ğŸ“– TO BE CONTINUED...</div><p>' + ch.cliffhanger.replace(/\n/g,'<br>') + '</p></div>';
  }

  html += '<div class="result-btns">';
  if (!isLastChapter) {
    html += '<button class="btn-home" onclick="startChapter(' + si + ',' + (ci+1) + ')">ë‹¤ìŒ ì±•í„°ë¡œ â†’</button>';
  } else if (!isLastSeries) {
    html += '<button class="btn-home" onclick="openSeries(' + (si+1) + ')">ë‹¤ìŒ ì‹œë¦¬ì¦ˆ â†’</button>';
  }
  html += '<button class="btn-home" style="background:var(--bg3);color:var(--text2)" onclick="goHome()">ğŸšª ë¡œë¹„ë¡œ ëŒì•„ê°€ê¸°</button>';
  html += '<button class="btn-share" onclick="shareResult()">ğŸ“¤ ê²°ê³¼ ê³µìœ í•˜ê¸°</button>';
  html += '</div>';

  document.getElementById('resultContent').innerHTML = html;
}

function shareResult() {
  var ch = state.currentChapter;
  var s = state.currentSeries;
  var elapsed = Math.floor((Date.now() - state.startTime) / 1000);
  var text = 'ğŸ” QUBE - ' + s.title + ' / ' + ch.title + '\nâ± ' + formatTime(elapsed) + 'ì— í´ë¦¬ì–´!\n\në‚˜ëŠ” íƒˆì¶œí–ˆë‹¤. ë‹¹ì‹ ì€?\nğŸ‘‰ https://qube.salmonholic.com';
  if (navigator.share) navigator.share({text: text});
  else { navigator.clipboard && navigator.clipboard.writeText(text); alert('í´ë¦½ë³´ë“œì— ë³µì‚¬ëìŠµë‹ˆë‹¤!'); }
}

function copyKeyword(el) {
  var text = el.textContent.replace('ğŸ” ','').trim();
  navigator.clipboard && navigator.clipboard.writeText(text);
  var orig = el.textContent;
  el.textContent = 'âœ“ ë³µì‚¬ë¨!';
  setTimeout(function(){ el.textContent = orig; }, 1500);
}

function spawnConfetti() {
  var container = document.createElement('div');
  container.className = 'confetti-container';
  document.body.appendChild(container);
  var colors = ['#b44aff','#00e5ff','#00ff88','#ff4444','#f59e0b','#fff'];
  for (var i = 0; i < 60; i++) {
    var piece = document.createElement('div');
    piece.className = 'confetti-piece';
    piece.style.left = Math.random()*100 + '%';
    piece.style.background = colors[Math.floor(Math.random()*colors.length)];
    piece.style.animationDelay = Math.random()*2 + 's';
    piece.style.animationDuration = (2 + Math.random()*2) + 's';
    var size = (6 + Math.random()*8) + 'px';
    piece.style.width = size;
    piece.style.height = size;
    piece.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
    container.appendChild(piece);
  }
  setTimeout(function(){ container.remove(); }, 5000);
}

// â”€â”€â”€ ì´ˆê¸°í™” â”€â”€â”€
createParticles();
renderHome();
</script>
</body>
</html>